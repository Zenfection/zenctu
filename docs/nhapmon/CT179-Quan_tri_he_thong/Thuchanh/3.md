# <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/11-13-29-20-AMBIENT%20USER%20EXPERIENCE.png" width="50"> Buá»•i 3 - Shell Scripting, quáº£n lÃ­ tiáº¿n trÃ¬nh, nháº­t kÃ½ há»‡ thá»‘ng

::: tip ğŸ“ TÃ€I NGUYÃŠN

[Download file buá»•i 3](https://drive.google.com/file/d/1PwUZCnC_xOH8mT89lxE9S2JyjADnVTUC/preview)
:::

## 1.CÃ i Ä‘áº·t CentOS

### CÃ¢u 1

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Thá»±c hiá»‡n cÃ i Ä‘áº·t `CentOS 6` (*hoáº·c `CentOS 7`, `8`*) vÃ o mÃ¡y tÃ­nh cÃ¡ nhÃ¢n (*hoáº·c mÃ¡y áº£o*) cá»§a báº¡n (*KHÃ”NG cáº§n chá»¥p mÃ n hÃ¬nh minh hoáº¡*)

Link file ISO [CentOS 8](https://www.centos.org/download/)

## 2. Quáº£n trá»‹ vá»›i `shell scripting`

### CÃ¢u 2.1 

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Thá»±c hiá»‡n cÃ¡c lá»‡nh bÃªn dÆ°á»›i vÃ  cho biáº¿t káº¿t quáº£ cá»§a chÃºng (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png))
> 
> ```shell
> $ hostname
> $ hostname -I
> $ whoami
> $ df -H
> $ ps -eo pid,%mem,%cpu,comm --sort -rss
> ```

- `hostname` : Kiá»ƒm tra host hiá»‡n táº¡i
  
  ![db0997500f9efdc0a48f.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/11-19-51-06-db0997500f9efdc0a48f.jpeg)

- `hostname -I` : Hiá»ƒn thá»‹ táº¥t cáº£ Ä‘á»‹a chá»‰ `IPv4` máº¡ng cá»§a host ()
  
  ![91cff89660589206cb49.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/11-19-51-01-91cff89660589206cb49.jpeg)

- `whoami` (*Who Am I*): hiá»ƒn thá»‹ ra ngÆ°á»i dÃ¹ng Ä‘ang thao tÃ¡c 
  
  ![c9aa14fc8c327e6c2723.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/11-19-51-04-c9aa14fc8c327e6c2723.jpeg)

- `df -H` : Kiá»ƒm tra thÃ´ng tin táº¥t cáº£ á»• cá»©ng 
  
  ![57c59f93075df503ac4c.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/11-19-50-56-57c59f93075df503ac4c.jpeg)

- `ps -eo pid,%mem,%cpu,comm --sort -rss | head -n 3` : *Giáº£i thÃ­ch bÃªn dÆ°á»›i*
  
  ![36faeaac7262803cd973.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/11-19-50-50-36faeaac7262803cd973.jpeg)
  
  ::: tip ğŸ’¡ GIáº¢I THÃCH
  
  - `ps` (*Process Status*) : cÃ´ng cá»¥ quáº£n lÃ­ tiáº¿n trÃ¬nh
  
  - `-eo` : Hiá»ƒn thá»‹ táº¥t cáº£ tiáº¿n trÃ¬nh cÃ³ chá»n lá»c 
  
  - `pid` (*Process ID*) : MÃ£ tiáº¿n trÃ¬nh
  
  - `%mem,%cpu` : Sá»­ dá»¥ng bá»™ nhá»› vÃ  vi xá»­ lÃ½ tiáº¿n trÃ¬nh (*`%`*) 
  
  - `comm` : Ä‘Æ°á»ng dáº«n cá»§a tiáº¿n trÃ¬nh 
  
  - `--sort` : sáº¯p xáº¿p tiáº¿n trÃ¬nh 
  
  - `-rss` (*resident set size*) : Ä‘i chung vá»›i `vsz`, hiá»ƒn thá»‹ **dung lÆ°á»£ng bá»™ nhá»›** Ä‘Æ°á»£c **phÃ¢n bá»•** cho tiáº¿n trÃ¬nh trong `RAM`
  
  - `| head -n 3` : sá»­ dá»¥ng **á»‘ng dáº«n** (`pipe`) Ä‘á»ƒ hiá»ƒn thá»‹ 3 dÃ²ng Ä‘áº§u tiÃªn  
  :::

### CÃ¢u 2.2

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Viáº¿t `shell script` cÃ³ tÃªn `info.sh` thá»±c hiá»‡n táº¥t cáº£ lá»‡nh á»Ÿ `2.1` (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png))

- Sá»­ dá»¥ng `gedit + <file>` Ä‘á»ƒ táº¡o file nhÆ° sau : 
  
  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/11-21-00-51-e0a0ab1c42d2b08ce9c3.jpeg" width="600">

- Sá»­ dá»¥ng lá»‡nh `bash + <file>` Ä‘á»ƒ thá»±c thi file :  

  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/11-21-00-56-7113cbae2260d03e8971.jpeg" width="450">

### CÃ¢u 2.3

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30">Viáº¿t `shell script` cÃ³ tÃªn `backup.sh` thá»±c hiá»‡n :
>
> - In ra ngÃ y giá» hiá»‡n táº¡i
> 
> - NÃ©n toÃ n bá»™ thÆ° má»¥c `/home` thÃ nh táº­p tin `/tmp/<YYYY-MM-DD>.tar` (*YYYY-MM-DD* lÃ  ngÃ y hiá»‡n táº¡i, vÃ­ dá»¥ : 2020-04-22.tar)
> 
> - In thÃ´ng tin Ä‘áº§y Ä‘á»§ cá»§a táº­p tin `/tpmn/<YYYY-MM-DD>.tar`
> 
> - In ra thÃ´ng tin thÃ´ng bÃ¡o `"Sao lÆ°u thÃ nh cÃ´ng!!!!"`
> 
> - Thá»±c thi `backup.sh` Ä‘á»ƒ kiá»ƒm tra (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png))

- Sá»­ dá»¥ng `gedit + <file>` Ä‘á»ƒ táº¡o file nhÆ° sau :
  
  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-01-15-63a7056934a0c6fe9fb1.jpeg" width="600">

- Sá»­ dá»¥ng lá»‡nh `bash + <file>` Ä‘á»ƒ thá»±c thi file :
  
  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-01-08-56752abb1b72e92cb063.jpeg">

## 3. LÃªn lá»‹ch cÃ´ng viá»‡c Ä‘á»‹nh ká»³ vá»›i `cron`

::: tip ğŸ’¡ KIáº¾N THá»¨C

`Cron` lÃ  má»™t tiá»‡n Ã­ch trong `Linux` cho phÃ©p mÃ¡y tÃ­nh thiáº¿t láº­p thá»i gian biá»ƒu Ä‘á»ƒ thá»±c hiá»‡n cÃ´ng viá»‡c má»™t cÃ¡ch Ä‘á»‹nh ká»³. Má»™t **file**  `crontab` chá»©a danh sÃ¡ch cÃ¡c lá»‡nh sáº½ Ä‘Æ°á»£c thá»±c thi, kÃ¨m theo thÃ´ng tin vá» thá»i Ä‘iá»ƒm láº·p láº¡i viá»‡c thá»±c thi. Äá»ƒ hiá»‡u chá»‰nh **file** `crontab` vá»›i trÃ¬nh soáº¡n tháº£o `nano`, ta dÃ¹ng lá»‡nh sau : 

```shell
$ export EDITOR=nano
$ crontab -e
```
:::

### CÃ¢u 3.1

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Cháº¡y lá»‡nh `date` má»—i phÃºt má»™t láº§n, sau Ä‘Ã³ khi káº¿t quáº£ vÃ o cuá»‘i táº­p tin `/tmp/date.txt` (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png))

DÃ¹ng lá»‡nh `export EDITOR=<tÃªn editor>`, Ä‘á»ƒ thay Ä‘á»•i trÃ¬nh chá»‰nh sá»­a máº·c Ä‘á»‹nh 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-24-20-8245ae92bd5b4f05164a.jpeg" width="450">

::: tip ğŸ’¡ GIáº¢I THÃCH

- `crontab -e` : chá»‰nh sá»­a file `crontab` 

- `crontab -l` : xem file `crontab` 

  ![68981e4e0d87ffd9a696.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-15-23-68981e4e0d87ffd9a696.jpeg)

- `crontab -r` : xoÃ¡ file `crontab`
:::

==> Sau má»™t phÃºt tá»± Ä‘á»™ng sáº½ cáº­p nháº­t giá» trong file `/tmp/data.txt` : 

![c7ef2b2638efcab193fe.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-15-25-c7ef2b2638efcab193fe.jpeg)

![121d92d4811d73432a0c.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-15-16-121d92d4811d73432a0c.jpeg)

### CÃ¢u 3.2

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Thá»±c thi `backup.sh` á»Ÿ `2.3` vÃ o `23:00 giá» ngÃ y 10,20 vÃ  30` **háº±ng thÃ¡ng** (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png))

![c93589fd9a34686a3125.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-15-26-c93589fd9a34686a3125.jpeg)

==> Cá»© má»—i `23h ngÃ y 10,20,30` háº±ng thÃ¡ng tá»± Ä‘á»™ng sáº½ thá»±c thi file `backup.sh`

## 4. Thao tÃ¡c vá»›i tiáº¿n trÃ¬nh

### CÃ¢u 4.1

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30">Má»Ÿ trÃ¬nh duyá»‡t `Firefox`. Sau Ä‘Ã³ dÃ¹ng lá»‡nh `ps -aux` *hoáº·c* `pgrep` tÃ¬m **PID** cá»§a `Firefox`. 
> 
> Tiáº¿p theo, dÃ¹ng lá»‡nh `kill` Ä‘á»ƒ táº¡m dá»«ng tiáº¿n trÃ¬nh `Firefox` (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png)). Äiá»u gÃ¬ xáº£y ra khi báº¡n dá»‹ch chuyá»ƒn cá»­a sá»• `Firefox` *hoáº·c* nháº¥n chá»n **menu** cá»§a nÃ³ ngay lÃºc nÃ y ?

- Sá»­ dá»¥ng lá»‡nh `pgrep` Ä‘á»ƒ tÃ¬m ID tiáº¿n trÃ¬nh : 
  
  ![69041d6b7ba289fcd0b3.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-47-43-69041d6b7ba289fcd0b3.jpeg)

- Sá»­ dá»¥ng lá»‡nh `kill -s STOP <PID>` sáº½ táº¡m dá»«ng tiáº¿n trÃ¬nh : 
  
  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-47-40-30a757c83101c35f9a10.jpeg" width="700">
  
  ::: warning ğŸ’¡ CHÃš Ã

  Ngay láº­p tá»©c ta khÃ´ng thá»ƒ thao tÃ¡c Ä‘Æ°á»£c gÃ¬ tá»« `Firefox`
  :::

### CÃ¢u 4.2

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> DÃ¹ng lá»‡nh `kill` Ä‘á»ƒ phá»¥c há»“i tráº¡ng thÃ¡i trÆ°á»›c Ä‘Ã³ cá»§a `Firefox` vÃ  quan sÃ¡t káº¿t quáº£ (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png))

Sá»­ dá»¥ng lá»‡nh sau Ä‘Ã¢y Ä‘á»ƒ khÃ´i phá»¥c tiáº¿n trÃ¬nh vá»«a dÃ¹ng : 

```shell
$ kill -s CONT <PID>
```

![AÌ‰nh chuÌ£p MaÌ€n hiÌ€nh 2021-04-12 luÌc 12.50.48.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-50-54-A%CC%89nh%20chu%CC%A3p%20Ma%CC%80n%20hi%CC%80nh%202021-04-12%20lu%CC%81c%2012.50.48.png) 

::: warning ğŸ’¡ CHÃš Ã

Ngay láº­p tá»©c ta cÃ³ thá»ƒ thao tÃ¡c `Firefox` láº¡i bÃ¬nh thÆ°á»ng 
:::
### CÃ¢u 4.3

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> DÃ¹ng lá»‡nh `kill` Ä‘á»ƒ huá»· tiáº¿n trÃ¬nh `Firefox` (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png))

Sá»­ dá»¥ng lÃªnh sau Ä‘Ã¢y Ä‘á»ƒ thoÃ¡t tiáº¿n trÃ¬nh ngay láº­p tá»©c : 

```shell
$ kill -s KILL <PID>
```

![AÌ‰nh chuÌ£p MaÌ€n hiÌ€nh 2021-04-12 luÌc 12.52.22.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-52-30-A%CC%89nh%20chu%CC%A3p%20Ma%CC%80n%20hi%CC%80nh%202021-04-12%20lu%CC%81c%2012.52.22.png)

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-51-38-ef8c72e3142ae674bf3b.jpeg" width="700">

::: warning ğŸ’¡ CHÃš Ã

Tiáº¿n trÃ¬nh `Firefox` ngay láº­p tá»©c sáº½ bá»‹ táº¯t Ä‘i.
:::

## 5. Táº­p tin log

### CÃ¢u 5.1

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> TÃ¬m thÃ´ng tin vá» ngÆ°á»i dÃ¹ng, thá»i gian cá»§a láº§n **Ä‘Äƒng nháº­p** sau cÃ¹ng vÃ o **há»‡ thá»‘ng** (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png))

Sá»­ dá»¥ng lá»‡nh `last` Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin nháº­t kÃ½ Ä‘Äƒng nháº­p trÃªn mÃ¡y:

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-59-26-aa6a590e2cc7de9987d6.jpeg" width="600">

::: tip ğŸ’¡ FACT

NhÆ°ng ta cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh `last` kÃ¨m theo **á»‘ng dáº«n** `head -n -1` Ä‘á»ƒ hiá»ƒn thá»‹ thá»i gian Ä‘Äƒng nháº­p cuá»‘i cÃ¹ng nhÆ° sau : 

![6c47c620b3e941b718f8.jpeg](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-12-53-40-6c47c620b3e941b718f8.jpeg)
:::

### CÃ¢u 5.2

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¡o má»™t ngÆ°á»i dÃ¹ng má»›i

Sá»­ dá»¥ng lá»‡nh `adduser` hoáº·c `useradd` Ä‘á»ƒ táº¡o ngÆ°á»i dÃ¹ng má»›i (*dÃ¹ng tÃ i khoáº£n root*) (*MÃ¬nh táº¡o tÃªn `newUser`*) 

### CÃ¢u 5.3

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> TÃ¬m **thá»i gian** ngÆ°á»i dÃ¹ng á»Ÿ `5.2` Ä‘Æ°á»£c táº¡o ra (*Chá»¥p mÃ n hÃ¬nh minh hoáº¡*![icons8screenshotpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-16-22-icons8-screenshot.png))

ThÃ´ng tin táº¡o ngÆ°á»i dÃ¹ng náº±m trong file `/var/log/secure`, sá»­ dá»¥ng lá»‡nh `cat` Ä‘á»ƒ in ra (*dÃ¹ng tÃ i khoáº£n `root`*)

::: tip ğŸ’¡ FACT

Ta nÃªn kÃ¨m theo **á»‘ng dáº«n** Ä‘á»ƒ tÃ¬m kiáº¿m nhanh hÆ¡n nhÆ° sau : 

![b2ad08ca7d038f5dd612.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/04/12-13-00-09-b2ad08ca7d038f5dd612.png)
:::

<comment/>
