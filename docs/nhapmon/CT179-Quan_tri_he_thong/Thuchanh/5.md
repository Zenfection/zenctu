# <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/07-12-46-11-icons8-dns.png"> Buá»•i 5 - `SAMBA`, `DNS` vÃ  `Firewall`

::: tip ğŸ“ TÃ€I NGUYÃŠN

[Download file buá»•i 5](https://drive.google.com/file/d/1gUtlIRYJ2q3Nl9u9Yotd3aakMnxLSHns/preview)
:::

## 1. CÃ i Ä‘áº·t CentOS

### CÃ¢u 1.1

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Thá»±c hiá»‡n cÃ i Ä‘áº·t `CentOS 6` (*hoáº·c `CentOS 7`, `8`*) vÃ o mÃ¡y tÃ­nh cÃ¡ nhÃ¢n (*hoáº·c mÃ¡y áº£o*)


Link file ISO [CentOS 8](https://www.centos.org/download/)

### CÃ¢u 1.2

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> CÃ i Ä‘áº·t dá»‹ch vá»¥ `Web Server` trÃªn mÃ¡y áº£o. Táº¡o má»™t trang web Ä‘Æ¡n giáº£n `index.html` lÆ°u vÃ o thÆ° má»¥c `/var/www/html/myweb`


ÄÃ£ lÃ m trong bÃ i thá»±c hÃ nh [Buá»•i 4](/nhapmon/CT179-Quan_tri_he_thong/Thuchanh/4.md)


## 2. CÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh `SAMBA`

::: tip ğŸ’¡ KIáº¾N THá»¨C

`Samba` lÃ  dá»‹ch vá»¥ chia sáº» `file` giá»¯a cÃ¡c ná»n táº£ng khÃ¡c nhau nhÆ° `Windows` vÃ  `Linux` báº±ng cÃ¡ch sá»­ dá»¥ng giao thá»©c `SMB/CIFS`. 
:::

### CÃ¢u 2.1

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> CÃ i Ä‘áº·t dá»‹ch vá»¥ `Samba`  báº±ng lá»‡nh : 
> 
> ```bash
> $ yum install samba
> ```


![Screenshot from 2021-05-09 11-04-12.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-18-16-Screenshot%20from%202021-05-09%2011-04-12.png)

==> Báº¡n cÃ³ thá»ƒ gÃµ `samba --version` Ä‘á»ƒ kiá»ƒm tra Ä‘Ã£ cÃ i Ä‘áº·t chÆ°a.

### CÃ¢u 2.2

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¡o ngÆ°á»i dÃ¹ng vÃ  nhÃ³m ngÆ°á»i dÃ¹ng chia sáº» dá»¯ liá»‡u:
> 
> ```bash
> $ adduser tuanthai
> $ passwd tuanthai
> $ groupadd lecturers
> $ usermod -aG lecturers tuanthai
> ```


![Screenshot from 2021-05-09 11-06-34.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-04-43-Screenshot%20from%202021-05-09%2011-06-34.png)

### CÃ¢u 2.3

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¡o thÆ° má»¥c cáº§n chia sáº» vÃ  phÃ¢n quyá»n : 
> 
> ```bash
> $ mkdir /data
> $ chgrp lecturers /data
> $ chmod -R 775 /data
> ```

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-06-02-Screenshot%20from%202021-05-09%2011-12-45.png" width="600">

### CÃ¢u 2.4

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Cáº¥u hÃ¬nh dá»‹ch vá»¥ `SAMBA`
> 
> ```bash
> $ cp /etc/samba/smb.conf /etc/samba/smb.conf.orig
> $ nano /etc/samba/smb.conf
> ```
> 
> ```textile
> ...
> [data]
>     comment = Shared folder for lecturers
>     path = /data
>     browsable = yes
>     writable = yes
>     read only = no
>     valid users = @lecturers
> ```

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-06-49-Screenshot%20from%202021-05-09%2011-16-49.png" width="600">

::: tip ğŸ’¡ GIáº¢I THÃCH 

- `comment` : chÃº thÃ­ch 

- `path` : Ä‘Æ°á»ng dáº«n Ä‘áº¿n thÆ° má»¥c cáº§n káº¿t ná»‘i `Samba`

- `browsafe` : kiá»ƒm soÃ¡t viá»‡c chia sáº» file cÃ³ Ä‘Æ°á»£c nhÃ¬n tháº¥y trong cháº¿ Ä‘á»™ thá»±c

- `writable` : Cho phÃ©p ghi file (*Ä‘áº£o ngÆ°á»£c vá»›i `read only`*)

- `read only`  : Chá»‰ cho phÃ©p Ä‘á»c (*Ä‘áº£o ngÆ°á»£c vá»›i `read only`*) 

- `valid users` : ngÆ°á»i dÃ¹ng cÃ³ hiá»‡u lá»±c

==> Tham kháº£o cÃ¡ch `config` [táº¡i Ä‘Ã¢y](https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html)
:::

### CÃ¢u 2.5

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> ThÃªm ngÆ°á»i dÃ¹ng cho dá»‹ch vá»¥ `SAMBA` báº±ng lá»‡nh : 
> 
> ```bash
> $ smbpasswd -a tuanthai
> ```


![Screenshot from 2021-05-09 11-17-34.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-07-42-Screenshot%20from%202021-05-09%2011-17-34.png)

### CÃ¢u 2.6

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Cáº¥u hÃ¬nh `SELINUX` cho phÃ©p `Samba`
> 
> ```bash
> $ setsebool -P samba_export_all_rw on
> $ setsebool -P samba_enable_home_dirs on
> ```


- `samba_export_all_rw` : cho phÃ©p xuáº¥t báº¥t ká»³ `files` hay `diretories` nÃ o, cho phÃ©p quyá»n **Ä‘á»c** vÃ  **ghi**

- `samba_enable_home_dirs on` : cho phÃ©p chia sáº» thÆ° má»¥c chÃ­nh cá»§a ngÆ°á»i dÃ¹ng

==> Tham kháº£o [táº¡i Ä‘Ã¢y](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/managing_confined_services/sect-managing_confined_services-samba-booleans)

### CÃ¢u 2.7

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¯t tÆ°á»ng lá»­a
> 
> ```bash
> $ service iptables stop
> ```


![Screenshot from 2021-05-09 11-19-36.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-10-12-Screenshot%20from%202021-05-09%2011-19-36.png)

### CÃ¢u 2.8

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥ `Samba` : 
> 
> ```bash
> $ service smb start
> ```

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-10-55-Screenshot%20from%202021-05-09%2011-20-05.png" width="600">

### CÃ¢u 2.9

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> TrÃªn mÃ¡y `Windows`, báº­t tÃ­nh nÄƒng há»— trá»£ `SMB1` : 
> 
> Má»Ÿ `Control Panel` â `Programs` â `Turn Windows feature on or off` â `SMB 1.0/CIFS FIle Sharing Support` â Chá»n `SMB 1.0/CIFS Client`
> 
> ![Screen Shot 2021-05-07 at 13.07.25.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/07-13-07-32-Screen%20Shot%202021-05-07%20at%2013.07.25.png)


==> CÃ i `CentOS` trÃªn á»• cá»©ng, khÃ´ng sá»­ dá»¥ng mÃ¡y áº£o, nÃªn khÃ´ng lÃ m bÆ°á»›c nÃ y

### CÃ¢u 2.10

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> TrÃªn `File Exployer`, chá»n tÃ­nh nÄƒng `Add a network location` Ä‘á»ƒ káº¿t ná»‘i tá»›i `Samba server` sá»­ dá»¥ng Ä‘á»‹a chá»‰ `\\<IP mÃ¡y CentOS>\data`


Thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau Ä‘á»ƒ káº¿t ná»‘i giao thá»©c `Samba` trÃªn `CentOS` : 

- **B1**: VÃ o `Nautilus` (*hay cÃ²n gá»i lÃ  Finder*) â‡¨ Chá»n `Other Locations` â‡¨ Äiá»n `IP` cá»§a mÃ¡y cháº¡y `Samba` â‡¨ Chá»n `Connect`
  
  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-12-52-Screenshot%20from%202021-05-09%2012-03-12.png" width="600">

- **B2**: Chá»n `Registerd User` vÃ  Ä‘iá»n *tÃ i khoáº£n* vÃ  *máº­t kháº©u* Ä‘Äƒng kÃ½ `Samba` á»Ÿ trÃªn â‡¨ Chá»n `Connect`
  
  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-14-31-Screenshot%20from%202021-05-09%2012-24-39.png" width="344">

- **B3**: Báº¡n cÃ³ thá»ƒ táº¡o `file` (*vÃ­ dá»¥ táº¡o `file1` nhÆ° sau*)
  
  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-16-48-Screenshot%20from%202021-05-09%2012-19-10.png" width="500">
  
  ::: tip ğŸ’¡ FACT

  VÃ o mÃ¡y káº¿t ná»‘i `Samba` kiá»ƒm tra nhÆ° sau : 
  
  ![Screenshot from 2021-05-09 12-19-36.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-17-11-Screenshot%20from%202021-05-09%2012-19-36.png)
  
  ==> NhÆ° Ä‘Ã£ tháº¥y `file1` Ä‘Ã£ xuáº¥t hiá»‡n
  :::

## 3. CÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh dá»‹ch vá»¥ `DNS`

::: tip ğŸ’¡ KIáº¾N THá»¨C

`DNS` (*Domain Name System*) lÃ  giáº£i phÃ¡p dÃ¹ng tÃªn miá»n thay cho Ä‘á»‹a chá»‰ `IP` khÃ³ nhá»› khi sá»­ dá»¥ng cÃ¡c dá»‹ch vá»¥ máº¡ng. Truy cáº­p Ä‘áº¿n `website` cá»§a `Khoa CNTT-ÄH Cáº§n ThÆ¡` báº±ng Ä‘á»‹a chá»‰ nÃ o dá»… hÆ¡n ?

| http://203.162.36.146 | http://cit.ctu.edu.vn |
| --------------------- | --------------------- |

Báº¡n cáº§n pháº£i cÃ i Ä‘áº·t pháº§n má»m `BIND` trÃªn `CentOS` Ä‘á»ƒ phÃ¢n giáº£i tÃªn miá»n `qtht.com.vn`
:::

### CÃ¢u 3.1

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> CÃ i Ä‘áº·t `BIND` vÃ  cÃ¡c cÃ´ng cá»¥ cáº§n thiáº¿t :
> 
> ```bash
> $ yum install bind bind-utils
> ```


![Screenshot from 2021-05-09 12-33-54.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-04-46-Screenshot%20from%202021-05-09%2012-33-54.png)

==> Báº¡n cÃ³ thá»ƒ gÃµ `named -v` Ä‘á»ƒ kiá»ƒm tra `bind-utils` Ä‘Ã£ cÃ i chÆ°a.

### CÃ¢u 3.2

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> CÃ i hÃ¬nh `DNS server` : 
> 
> ```bash
> $ nano /etc/named.conf 
> ```
> 
> ```textile
> ...
> option {
>     listen-on port 53 { 127.0.0.1; any;};
>     ...
>     allow-query    { localhost; any;};
>     recursion yes;
>     ...
> };
> 
> loggin {
>     ...
>     };
> };
> 
> zone "." IN {
>     ...
> };
> 
> zone "<tÃªn miá»n>" IN {
>     type master;
>     file "forward.qtht";
>     allow-update { none; };
> };
> 
> zone "<24bit máº¡ng Ä‘áº£o chiá»u>.in-addr.arpa" IN {
>     type master;
>     file "reverse.qtht";
>     allow-update { none; };
> };
> ...
> ```

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-10-02-Screenshot%20from%202021-05-09%2012-36-20.png" width="600">

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-28-17-Screenshot%20from%202021-05-09%2013-17-02.png" width="600">

### CÃ¢u 3.3

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¡o táº­p tin cáº¥u hÃ¬nh phÃ¢n giáº£i xuÃ´i:
> 
> ```bash
> $ cp /var/named/named.localhost /var/named/forward.qtht
> $ chgrp named /var/named/forward.qtht
> $ nano /var/named/forward.qtht
> ```
> 
> ```textile
> $TTL 1D
> @   IN  SOA @ <tÃªn miá»n>. (
> 0     ;Serial
> 1D    ;Refresh
> 1H    ;Retry
> 1W    ;Expire
> 3H    ;Minimum TTL
> )
> @    IN    NS    dns.qtht.com.vn.
> dns  IN    A    <IP mÃ¡y>
> www  IN    A    <IP mÃ¡y>
> htql IN    A    8.8.8.8
> ```


![Screenshot from 2021-05-09 08-35-44.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-26-57-Screenshot%20from%202021-05-09%2008-35-44.png)

### CÃ¢u 3.4

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¡o táº­p tin cáº¥u hÃ¬nh phÃ¢n giáº£i ngÆ°á»£c :
> 
> ```bash
> $ cp /var/named/forward.qtht /var/named/reverse.qtht
> $ chgrp named /var/named/reverse.qtht
> $ nano /var/named/reverse.qtht
> ```
> 
> ```textile
> $TTL 1D
> @   IN  SOA @ qtht.com.vn. (
> 0    ;Serial
> 1D    ;Refresh
> 1H    ;Retry
> 1W    ;Expire
> 3H    ;Minimum TTL
> )
> @    IN   NS   dns.qtht.com.vn.
> dns  IN   A    <IP mÃ¡y>
> 245  IN   PTR  www.qtht.com.vn.
> ```

![Screenshot from 2021-05-09 08-36-00.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-38-46-Screenshot%20from%202021-05-09%2008-36-00.png)

### CÃ¢u 3.5

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¯t tÆ°á»ng lá»­a 
> 
> ```bash
> $ service iptables stop
> ```

![Screenshot from 2021-05-09 11-19-36.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-18-10-12-Screenshot%20from%202021-05-09%2011-19-36.png)

### CÃ¢u 3.6

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥ `DNS`
> 
> ```bash
> $ service named start
> ```

![Screenshot from 2021-05-09 13-09-56.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-40-08-Screenshot%20from%202021-05-09%2013-09-56.png)

### CÃ¢u 3.7

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Kiá»ƒm tra káº¿t quáº£ 
> 
> ```bash
> $ nslookup www.qtht.com.vn <Ä‘á»‹a chá»‰ IP mÃ¡y>
> ```


- PhÃ¢n giáº£i xuÃ´i 
  
  ![Screenshot from 2021-05-09 08-38-46.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-40-53-Screenshot%20from%202021-05-09%2008-38-46.png)

- PhÃ¢n giáº£i ngÆ°á»£c
  
  ![Screenshot from 2021-05-09 08-38-37.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-41-47-Screenshot%20from%202021-05-09%2008-38-37.png)

### CÃ¢u 3.8

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> TrÃªn mÃ¡y váº­t lÃ½, cáº¥u hÃ¬nh `DNS Server` lÃ  `IP` cá»§a mÃ¡y áº£o `CentOS`. Sau Ä‘Ã³ má»Ÿ trÃ¬nh duyá»‡t `web` vÃ  truy cáº­p vÃ o Ä‘á»‹a chá»‰ `http://www.qtht.com.vn/myweb`


![Screenshot from 2021-05-09 08-33-53.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-42-52-Screenshot%20from%202021-05-09%2008-33-53.png)

::: tip ğŸ’¡ FACT

CÅ©ng cÃ³ thá»ƒ dÃ¹ng Ä‘iá»‡n thoáº¡i Ä‘á»ƒ káº¿t ná»‘i (*YÃªu cáº§u xÃ i chung `Wifi` vÃ  thiáº¿t láº­p `DNS custom`* )

<img title="" src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-47-58-a4d2f03b003ff561ac2e.png" alt="a4d2f03b003ff561ac2e.png" width="250"> <img title="" src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-48-19-8f08fed60ed2fb8ca2c3.png" alt="8f08fed60ed2fb8ca2c3.png" width="250">
:::

## 4. Cáº¥u hÃ¬nh tÆ°á»ng lá»­a `iptables`

::: tip ğŸ’¡ KIáº¾N THá»¨C

`iptables` lÃ  má»™t bá»™ cÃ´ng cá»¥ Ä‘Æ°á»£c tÃ­ch há»£p trÃªn há»‡ Ä‘iá»u hÃ nh `Linux` Ä‘á»ƒ thá»±c hiá»‡n chá»©c nÄƒng tÆ°á»ng lá»­a theo cÆ¡ cháº¿ lá»c gÃ³i tin (`package filtering`). `Iptables` theo dÃµi lÆ°u lÆ°á»£ng máº¡ng **Ä‘áº¿n** vÃ  **Ä‘i** cá»§a má»™t mÃ¡y tÃ­nh vÃ  lá»c nÃ³ dá»±a trÃªn cÃ¡c luáº­t (`rules`) do ngÆ°á»i dÃ¹ng tá»± Ä‘á»‹nh nghÄ©a trÆ°á»›c Ä‘Ã³.
:::

### CÃ¢u 4.1

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Thá»±c thi tÆ°á»ng lá»­a
> 
> ```bash
> $ service iptables start
> ```


![Screenshot from 2021-05-09 09-13-04.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-55-08-Screenshot%20from%202021-05-09%2009-13-04.png)

### CÃ¢u 4.2

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Hiá»ƒn thá»‹ cÃ¡c `rules` hiá»‡n cÃ³ trÃªn `iptables`
> 
> ```bash
> $ iptables -v -L --line-numbers
> ```


![Screenshot from 2021-05-09 09-18-28.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-56-01-Screenshot%20from%202021-05-09%2009-18-28.png)

::: tip ğŸ’¡ GIáº¢I THÃCH

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-57-56-iptables_filter.png" title="" alt="iptables_filter.png" width="525">

| Giáº£i thÃ­ch | INPUT                                                 | FORWARD                                                              | OUTPUT                                                  |
| ---------- | ----------------------------------------------------- | -------------------------------------------------------------------- | ------------------------------------------------------- |
| Trá»«u tÆ°á»£ng | Kiá»ƒm soÃ¡t cÃ¡c gÃ³i Ä‘áº¿n tá»« `route` Ä‘áº¿n `server` cá»§a báº¡n | Kiá»ƒm soÃ¡t cÃ¡c gÃ³i báº¯t nguá»“n tá»« `server` cá»§a báº¡n Ä‘áº¿n `nhÃ  máº¡ng`       | Kiá»ƒm soÃ¡t cÃ¡c gÃ³i Ä‘Æ°á»£c chuyá»ƒn tiáº¿p bá»Ÿi `server` cá»§a báº¡n |
| Dá»… hiá»ƒu    | Lá»c cÃ¡c gÃ³i dÃ nh cho `server` cá»§ báº¡n                  | Lá»c cÃ¡c gÃ³i Ä‘áº¿n `server` cá»§a báº¡n mÃ  `card wifi` khÃ¡c cÃ³ thá»ƒ truy cáº­p | Lá»c cÃ¡c gÃ³i cÃ³ nguá»“n gá»‘c tá»« `server` cá»§a báº¡n            |
:::

### CÃ¢u 4.3

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¡o `rules` cho phÃ©p cÃ¡c mÃ¡y khÃ¡c truy cáº­p tá»›i dá»‹ch vá»¥ `Web` trÃªn `server`
> 
> ```bash
> $ iptables -A INPUT -p tcp --dport 80 -j ACCEPT
> ```


Tham kháº£o cÃ¡ch dÃ¹ng `iptables` cÄƒn báº£n [táº¡i Ä‘Ã¢y](https://hocvps.com/iptables/) 

- **TrÆ°á»›c** khi cho mÃ¡y khÃ¡c truy cáº­p vá»›i dá»‹ch vá»¥ `Web Server` : 
  
  <img title="" src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-22-49-33363b9e5d9fa8c1f18e.png" alt="33363b9e5d9fa8c1f18e.png" width="229">

- **Sau** khi cho mÃ¡y khÃ¡c truy cáº­p tá»›i dá»‹ch vá»¥ `Web Server` báº±ng lá»‡nh trÃªn : 
  
  ![Screenshot from 2021-05-09 09-50-53.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-24-12-Screenshot%20from%202021-05-09%2009-50-53.png)
  
  <img title="" src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/09-23-47-58-a4d2f03b003ff561ac2e.png" alt="a4d2f03b003ff561ac2e.png" width="227">

### CÃ¢u 4.4

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¡o `rules` Ä‘á»ƒ cho mÃ¡y váº­t lÃ½ cÃ³ thá»ƒ `ping` tá»›i `server`, cÃ¡c mÃ¡y khÃ¡c **KHÃ”NG** `ping` Ä‘Æ°á»£c
> 
> ```bash
> $ iptables -I INPUT 2 -p icmp -s <IP cho phÃ©p> -j ACCEPT
> ```


Sá»­ dá»¥ng <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-26-32-1406098-200.png" title="" alt="1406098-200.png" width="35"> [Termux](https://termux.com/) cá»§a `Android` Ä‘á»ƒ thao tÃ¡c cÃ¡c lá»‡nh 

::: warning ğŸ¤” LÆ¯U Ã

`Android` Ä‘ang sá»­ dá»¥ng chung máº¡ng `Wifi` cá»§a mÃ¡y dÃ¹ng `iptables` vÃ  cÃ³ IP nhÆ° sau : `192.168.10.101` (*riÃªng mÃ¡y nÃ y thÃ´i !*)
:::

- TrÆ°á»›c khi thiáº¿t láº­p `rules` cháº·n `ping`  :
  
  - ![icons8-android.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-31-23-icons8-android.png)`Android` sá»­ dá»¥ng `ping`
    
    <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-29-10-bd39e9ee27ead2b48bfb.jpeg" width="600">
  
  - ![icons8-centos.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-31-36-icons8-centos.png) `CentOS` sá»­ dá»¥ng `ping` 
    
    ![Screenshot from 2021-05-09 09-54-50.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-30-42-Screenshot%20from%202021-05-09%2009-54-50.png)
  
  ==> Cáº£ hai váº«n `ping` Ä‘Æ°á»£c

- **Sau** khi thiáº¿t láº­p `rules` cháº·n `ping` báº±ng lá»‡nh trÃªn : 
  
  ![Screenshot from 2021-05-09 09-58-15.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-35-55-Screenshot%20from%202021-05-09%2009-58-15.png)
  
  ::: warning ğŸ¤” LÆ¯U Ã
  
  `qtht.com.vn` tÆ°Æ¡ng Ä‘Æ°Æ¡ng `192.168.10.135` vÃ¬ Ä‘Ã£ cáº¥u hÃ¬nh `DNS` bÃªn trÃªn
  :::
  
  - ![icons8androidpng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-31-23-icons8-android.png)`Android` sá»­ dá»¥ng `ping`
    
    <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-34-38-3924f2fe3cfac9a490eb.png" width="600">
  
  - ![icons8centospng](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-31-36-icons8-centos.png) `CentOS` sá»­ dá»¥ng `ping`
    
    ![Screenshot from 2021-05-09 09-54-50.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-00-30-42-Screenshot%20from%202021-05-09%2009-54-50.png)

Â Â Â Â Â Â Â Â Â ==> Sau khi thiáº¿t láº­p `rules` chá»‰ cÃ³ mÃ¡y cÃ³ `IP:192.168.10.135` lÃ  `ping` Ä‘Æ°á»£c Ä‘áº¿n `server`. 

### CÃ¢u 4.5

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> Táº¡o `rules` Ä‘á»ƒ **KHÃ”NG** cho ngÆ°á»i dÃ¹ng trÃªn mÃ¡y `CentOS` truy cáº­p tá»›i Ä‘á»‹a chá»‰ `facebook.com`
> 
> ```bash
> $ iptables -A OUTPUT -p tcp -m string --string facebook --algo kmp -j REJECT
> ```


Sá»­ dá»¥ng lá»‡nh trÃªn Ä‘á»ƒ gá»­i gÃ³i truy cáº­p Ä‘áº¿n `server` cá»§a `Facebook` : 

![Screenshot from 2021-05-09 10-13-39.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-10-32-04-Screenshot%20from%202021-05-09%2010-13-39.png)

==> Sau khi Ä‘Ã£ Ã¡p dá»¥ng `rules` thÃ¬ chÃºng ta khÃ´ng thá»ƒ truy cáº­p `facebook` Ä‘Æ°á»£c ná»¯a : 

![Screenshot from 2021-05-09 10-16-54.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-10-34-18-Screenshot%20from%202021-05-09%2010-16-54.png)

### CÃ¢u 4.6

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/03/17-20-06-29-icons8-questions.png" width="30"> LÆ°u vÃ  phá»¥c há»“i cÃ¡c `rules` cá»§a `iptables`
> 
> ```bash
> $ cp /etc/sysconfig/iptables /etc/sysconfig/iptables.orig
> $ iptables-save > /etc/sysconfig/iptables
> $ iptables-restore < /etc/sysconfig/iptables
> ```


TrÆ°á»›c khi táº¯t `iptables`, ta nÃªn **sao lÆ°u** (*backup*) láº¡i `rules` báº±ng lá»‡nh : 

```bash
$ iptables-save > /etc/sysconfig/iptables
```

::: warning ğŸ¤” LÆ¯U Ã

VÃ¬ sau khi **táº¯t** `iptables` vÃ  **khá»Ÿi Ä‘á»™ng** láº¡i, cÃ¡c `rules` thiáº¿t láº­p trÆ°á»›c Ä‘Ã³ sáº½ reset nhÆ° sau : 

![Screenshot from 2021-05-09 10-20-30.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-10-37-00-Screenshot%20from%202021-05-09%2010-20-30.png)
:::

==> Khi Ä‘Ã³ ta cÃ³ thá»ƒ **khÃ´i phá»¥c** (*restore*) láº¡i `rules` Ä‘Ã£ **sao lÆ°u** (*backup*) báº±ng lá»‡nh sau:

```bash
$ iptables-restore < /etc/sysconfig/iptables
```

::: tip ğŸ§š Káº¾T QUáº¢

![Screenshot from 2021-05-09 10-20-59.png](https://raw.githubusercontent.com/Zenfection/Image/master/2021/05/10-10-39-11-Screenshot%20from%202021-05-09%2010-20-59.png)

(*VÃ¬ mÃ¬nh Ä‘Ã£ xoÃ¡ `rules` cháº·n `facebook` trÆ°á»›c Ä‘Ã³ nÃªn khÃ´ng cÃ²n á»Ÿ OUTPUT ná»¯a*)
:::

<comment/>
