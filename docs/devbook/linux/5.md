# B√†i 5: Th√¥ng tin h·ªá th·ªëng

## 1. Th·ªëng k·∫ø CPU, RAM, Network, Disk

D∆∞·ªõi ƒë√¢y l√† c√°c l·ªánh c∆° b·∫£n ƒë·ªÉ th·ªëng k√™ v√† theo d√µi th·ªùi gian th·ª±c c√°c t√†i nguy√™n c·ªßa m√°y t√≠nh: 

| Th·ªëng k√™ | L·ªánh                                                          | Ch·ª©c nƒÉng                                                                                       |
| -------- | ------------------------------------------------------------- | ----------------------------------------------------------------------------------------------- |
| CPU      | mpstat                                                        | Th·ªëng k√™ s·ª≠ d·ª•ng CPU                                                                            |
| RAM      | vmstat                                                        | Th·ªëng k√™ s·ª≠ d·ª•ng Memory Ram                                                                     |
| Disk     | iostat                                                        | Th·ªëng k√™ s·ª≠ d·ª•ng ·ªï c·ª©ng                                                                         |
| Network  | netstat -ntlp<br>netstat -nulp<br>netstat -nxlp<br>sudo iftop | M·ªü socket `TCP`<br>M·ªü socket `UDP`<br>M·ªü socket `Unix`<br>Ph·∫ßn m·ªÅm theo d√µi m·∫°ng th·ªùi gian th·ª±c |
| T·∫•t c·∫£   | dstat                                                         | Ph·∫ßn m·ªÅm th·ªëng k·∫ø c√°c th·ª© b√™n tr√™n                                                              |

::: warning ‚ö†Ô∏è L∆ØU √ù

- `iftop` v√† `dstat` l√† m·ªôt ph·∫ßn m·ªÅm v·∫≠y n√™n n·∫øu kh√¥ng c√≥ s·∫µn th√¨ b·∫°n h√£y c√†i n√≥

- T·∫•t c·∫£ l·ªánh d∆∞·ªõi ƒë√¢y l√† c∆° b·∫£n, h√£y g√µ `--help` ƒë·ªÉ h·ªçc c√°ch s·ª≠ d·ª•ng n√≥

:::

## 2. Th√¥ng tin CPU

`CPU` l√† linh h·ªìn c≈©ng nh∆∞ s·ª©c m·∫°nh c·ªßa m·ªôt m√°y t√≠nh, v·∫≠y n√™n bi·∫øt ƒë∆∞·ª£c `CPU` ra sao, s·∫Ω cho b·∫°n bi·∫øt m√°y t√≠nh b·∫°n m·∫°nh th·∫ø n√†o

C√≥ nhi·ªÅu c√°ch ƒë·ªÉ bi·∫øt ƒë∆∞·ª£c th√¥ng tin `CPU` trong `Linux`, h√£y tham kh·∫£o c√°c c√°ch sau:

### L·ªánh lscpu

S·ª≠ d·ª•ng l·ªánh `lscpu` (*list cpu*) ƒë·ªÉ hi·ªÉn th·ªã c√°c th√¥ng tin c∆° b·∫£n c·ªßa CPU ƒëang s·ª≠ d·ª•ng 

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2022/02/15-15-14-07-Screenshot%202022-02-15%20151357.png" title="" alt="Screenshot 2022-02-15 151357.png" width="508">
> 
> ....

### L·ªánh lshw

S·ª≠ d·ª•ng l·ªánh `lshw` (*list hardware*) ƒë·ªÉ hi·ªÉn th·ªã danh s√°ch c√°c ph·∫ßn c·ª©ng trong m√°y t√≠nh nh∆∞ `CPU`, `RAM`, `Disk`, `Mainboard`, `Firmware`....

```bash:no-line-numbers
$ sudo lshw | grep cpu¬†¬†¬†¬†# in th√¥ng tin cpu
```

### Th√¥ng tin cpuinfo

Th√¥ng tin `CPU` c·ªßa m√°y ƒë∆∞·ª£c `Linux` l∆∞u tr·ªØ ·ªü `/proc/cpuinfo`

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2022/02/15-15-35-33-Screenshot%202022-02-15%20153524.png" title="" alt="Screenshot 2022-02-15 153524.png" width="474">
> 
> ...

::: tip üí°M·∫∏O

ƒê·ªÉ bi·∫øt nhanh s·ªë nh√¢n & lu·ªìng c·ªßa `CPU` bao nhi√™u ta d√πng l·ªánh sau:

```bash:no-line-numbers
$ grep -c processor /proc/cpuinfo
```

:::

## 3. Danh s√°ch ph·∫ßn c·ª©ng

ƒê√¥i khi ch√∫ng ta c·∫ßn bi·∫øt c·∫ßn ph·∫ßn c·ª©ng nh∆∞ `USB`, `PCI` c√°c thi·∫øt b·ªã ngo·∫°i vi ƒë√£ ƒë∆∞·ª£c `Linux` nh·∫≠n h√£y ch∆∞a, v√¨ th·∫ø ta ph·∫£i c√≥ l·ªánh ki·ªÉm tra n√≥

| Ph·∫ßn c·ª©ng | L·ªánh                                          |
| --------- | --------------------------------------------- |
| PCI       | lspci -tv                                     |
| USB       | lsusb -tv                                     |
| BIOS      | sudo dmidecode -q \| less                     |
| ·ªî c·ª©ng    | hdparm -i `ƒë∆∞·ªùng d·∫´n`<br>(*v√≠ d·ª• `/dev/sda`*) |

> ü§î D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë v√≠ d·ª• n√¢ng cao
> 
> | L·ªánh                                | Ch·ª©c nƒÉng                                                                           |
> | ----------------------------------- | ----------------------------------------------------------------------------------- |
> | smartctl -A /dev/sda Power_On_Hours | hi·ªÉn th·ªã th·ªùi gian ho·∫°t ƒë·ªông c·ªßa ·ªï c·ª©ng `/dev/sda`                                  |
> | hdparm -tT /dev/sda                 | Test t·ªëc ƒë·ªô ƒë·ªçc ghi c·ªßa ·ªï c·ª©ng `/dev/sda`                                           |
> | badblocks -s /dev/sda               | Ki·∫ªm tra xem ·ªï c·ª©ng `/dev/sda`¬†c√≥ b·ªã `badblock`¬†kh√¥ng (*t·ª©c l√† kh√¥ng th·ªÉ ƒë·ªçc ƒë∆∞·ª£c*) |

## 4. Gi√°m s√°t ti·∫øn tr√¨nh v√† thu th·∫≠p th√¥ng tin

Ch√∫ng ta c√≥ ƒë·ªÉ gi√°m s√°t c√°c ti·∫øn tr√¨nh nh∆∞ sau:

### Gi√°m s√°t tƒ©nh

L·ªánh ph·ªï bi·∫øn nh·∫•t l√† `ps` (*process status*) ƒë·ªÉ gi√°m s√°t c√°c th√¥ng tin v·ªÅ ti·∫øn tr√¨nh ƒëang ch·∫°y tr√™n m√°y

D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë tu·ª≥ ch·ªçn ph·ªï bi·∫øn: 

| L·ªánh                                                          | Ch·ª©c nƒÉng                                                   |
| ------------------------------------------------------------- | ----------------------------------------------------------- |
| ps -e -o pid,args --forest                                    | Danh s√°ch ti·∫øn tr√¨nh theo c·∫•p b·∫≠c                           |
| ps -e -o pcpu,cpu,cputime,args --sort pcpu \| sed '/^ 0.0 /d' | Danh s√°ch ti·∫øn tr√¨nh ƒë√£ s·∫Øp x·∫øp theo `%`¬†s·ª≠ d·ª•ng cpu        |
| ps -e -orss=,args= \| sort -b -k1,1n \| pr -TW$COLUMNS        | Danh s√°ch ti·ªÅn tr√¨nh ƒë√£ s·∫Øp x·∫øp theo `%`¬†s·ª≠ d·ª•ng ram (`KB`) |
| ps -C firefox-bin -L -o pid,tid,pcpu,state                    | Hi·ªÉn th·ªã t·∫•t c·∫£ ti·∫øn tr√¨nh c√≥ t√™n `firefox-bin`¬†ƒëang ch·∫°y   |

Sau khi t√¨m th·∫•y dc `PID` c·ª• th·ªÉ b·∫±ng c√°c l·ªánh tr√™n, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh sau ƒë·ªÉ tra n√≥:

```bash:no-line-numbers
$ lsof -p <PID>
```

### Gi√°m s√°t t∆∞∆°ng t√°c

L√† gi√°m s√°t c√°c ti·∫øn tr√¨nh nh∆∞ `ps` v√† c·∫≠p nh·∫≠t theo th·ªùi gian th·ª±c

L·ªánh ph·ªï bi·∫øn nh·∫•t cho gi√°m s√°t ƒë·ªông l√† `top`: 

> ![Screenshot 2022-02-15 181239.png](https://raw.githubusercontent.com/Zenfection/Image/master/2022/02/15-18-12-48-Screenshot%202022-02-15%20181239.png)

==> Tuy nhi√™n hi·ªán nay c√≥ r·∫•t nhi·ªÅu c√¥ng c·ª• t·ªët h∆°n, m·ªôt trong s·ªë ƒë√≥ l√†:

#### htop

> ![Screenshot 2022-02-15 181128.png](https://raw.githubusercontent.com/Zenfection/Image/master/2022/02/15-18-12-12-Screenshot%202022-02-15%20181128.png)

#### atop

> ![Screenshot 2022-02-15 181142.png](https://raw.githubusercontent.com/Zenfection/Image/master/2022/02/15-18-13-02-Screenshot%202022-02-15%20181142.png)

#### iotop

> ‚ö†Ô∏è D√πng ·ªü quy·ªÅn `root`
> 
> ![Screenshot 2022-02-15 181200.png](https://raw.githubusercontent.com/Zenfection/Image/master/2022/02/15-18-13-26-Screenshot%202022-02-15%20181200.png)
