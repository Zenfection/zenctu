# B√†i 4: document-ready event

## 1.Kh√°i ni·ªám v√† c√°ch s·ª≠ d·ª•ng

Code c·ªßa `jQuery` th∆∞·ªùng n·∫±m trong `(function($) { ... })` ƒë·ªÉ n√≥ ch·∫°y khi `DOM` t·∫£i ho√†n th√†nh.

```html:no-line-numbers
<script>
  jQuery(function($) {
    $("#myDiv").text("Hello");
    // t·∫•t c·∫£ th·∫ª c√≥ id="myDiv" ƒë·ªÅu thay ƒë·ªïi n·ªôi dung l√† "Hello"
  });
</script>
```


::: danger üö® C·∫¢NH B√ÅO

N·∫øu b·∫°n kh√¥ng c√≥ d√≤ng `function($){...}` th√¨ b·∫°n kh√¥ng th·ªÉ ch·ªçn ph·∫ßn t·ª≠ `DOM` v√¨ n√≥ ch∆∞a ƒë∆∞·ª£c t·∫£i nh∆∞ sau:

```html:no-line-numbers
<script>
  $("#myDiv").text("Hello");
  // th·ªùi ƒëi·ªÉm n√†y th√¨ id="myDiv" ch∆∞a ƒë∆∞·ª£c t·∫£i l√™n DOM
  // n√™n m·ªçi thao t√°c b·∫°n ƒë·ªÅu v√¥ hi·ªáu
</script>
```
:::

::: warning ‚ö†Ô∏è L∆ØU √ù

- B·∫°n c√≥ th·ªÉ ƒë·∫∑t b√≠ danh cho `jQuery` b·∫±ng h√†m `ready()`, r·∫•t h·ªØu d·ª•ng trong vi·ªác m·ªôt th∆∞ vi·ªán `JS` kh√°c s·ª≠ d·ª•ng `$` l√†m b√≠ danh.

- ƒê·ªÉ tr√°nh s·ª± xung ƒë·ªôt n√†y, b·∫°n ph·∫£i s·ª≠ d·ª•ng h√†m `$.noConflict()`, n√≥ ch·ªâ c√≥ th·ªÉ s·ª≠ d·ª•ng tr√™n kh√¥ng gian c·ªßa h√†m `jQuery`

```js:no-line-numbers
$.noConflict();
jQuery( document ).ready(function( $ ){
  // ta c√≥ th·ªÉ s·ª≠ d·ª•ng $ l√†m b√≠ danh 
  // m√† kh√¥ng xung ƒë·ªôt v·ªõi b√≠ danh c·ªßa th∆∞ vi·ªán kh√°c
  $('body').append('<div>Hello</div>')
})

jQuery( document ).ready(function( jq ) {
  //ta s·ª≠ d·ª•ng jq l√†m b√≠ danh c·ªßa jQuery
  jq('body').append('<div>Hello</div>')
});
```
:::

::: tip üí° M·∫∏O 

Thay v√¨ code `jQuery` ·ªü cu·ªëi trang, h√£y s·ª≠ d·ª•ng `$(document).ready(function(){...})`, ƒë·ªÉ ch·ªù ƒë·∫øn khi `DOM` t·∫£i xong r·ªìi code `jQuery` m·ªõi ƒë∆∞·ª£c th·ª±c thi
:::

## 2. jQuery `2.2.3` v√† tr∆∞·ªõc ƒë√≥

`jQuery` ch·ªâ ch·∫°y khi t·∫•t c·∫£ c·∫•u tr√∫c `DOM` ƒë·ªÅu s·∫µn s√†ng

```js:no-line-numbers
$(function() {
  // code
});
```

```js:no-line-numbers
$().ready(function() {
  // code
});
```

```js:no-line-numbers
$(document).ready(function() {
  // code
});
```

::: tip üí° KHUY·∫æT KH√çCH

V√¨ c·∫£ 3 c√°ch tr√™n t∆∞∆°ng ƒë∆∞∆°ng nhau, n√™n c√°ch ƒë·∫ßu ti√™n ƒë∆∞·ª£c khuy·∫øt kh√≠ch s·ª≠ d·ª•ng t·ª´ kh√≥a `jQuery` thay cho `$`:

```js:no-line-numbers
jQuery(function() {
// code
});
```
:::

## 3. jQuery `3.0`

### K√Ω hi·ªáu

·ªû `jQuery 3.0` ƒë√¢y l√† m·∫´u khuy·∫øt kh√≠ch s·ª≠ d·ª•ng: 

```js:no-line-numbers
jQuery(function($) {
  // Ch·∫°y khi DOM s·∫µn s√†ng
  // ƒë·ªëi s·ªë $ (ƒë·∫ßu ti√™n) s·∫Ω tham chi·∫øu n·ªôi b·ªô ƒë·∫øn jQuery
  // kh√¥ng d·ª±a v√†o $ tham chi·∫øu t·ªõi jQuery trong global namespace
});
```

> Tham kh·∫£o [document-ready handlers trong jQuery 3.0](https://jquery.com/upgrade-guide/3.0/#deprecated-document-ready-handlers-other-than-jquery-function)

### Kh√¥ng ƒë·ªìng b·ªô

As of jQuery 3.0, the ready handler [will always be called asynchronously](https://jquery.com/upgrade-guide/3.0/#breaking-change-document-ready-handlers-are-now-asynchronous). This means that in the code below, the log
'outside handler' will always be displayed first, regardless whether the document was ready at the point of
execution.

```js
$(function() {
console.log("inside handler");
});
console.log("outside handler");
```

> outside handler
> 
> inside handler

## 4. 

Example uses of $(document).ready():

### 1. Attaching event handlers

  Attach jQuery event handlers

  ```js
  $(document).ready(function() {
  $("button").click(function() {
  // Code for the click function  
  });
  });
  ```

### 2. Run jQuery code after the page structure is created

```js
jQuery(function($) {
  // set the value of an element.
  $("#myElement").val("Hello");
});
```

### 3. Manipulate the loaded DOM structure

For example: hide a div when the page loads for the first time and show it on the click event of a button

```js
$(document).ready(function() {
$("#toggleDiv").hide();
$("button").click(function() {
$("#toggleDiv").show();
});
});
```

## 5.

`$(window).load()` was deprecated in jQuery version 1.8 (and completely removed from jQuery 3.0) and as
such should not be used anymore. The reasons for the deprecation are noted on the [jQuery page about this event](http://api.jquery.com/load-event/)

> Caveats of the load event when used with images
>
> A common challenge developers attempt to solve using the .load() shortcut is to execute a function when an image (or collection of images) have completely loaded. There are several known caveats with this that should be noted. These are:
>
> - It doesn't work consistently nor reliably cross-browser
> 
> - It doesn't fire correctly in WebKit if the image src is set to the same src as before
> 
> - It doesn't correctly bubble up the DOM tree
>
> - Can cease to fire for images that already live in the browser's cache

If you still wish to use load() it is documented below:

$(document).ready() waits until the full DOM is availble -- all the elements in the HTML have been parsed and are
in the document. However, resources such as images may not have fully loaded at this point. If it is important to
wait until all resources are loaded, $(window).load() and you're aware of the significant limitations of this
event then the below can be used instead:

```js
$(document).ready(function() {
console.log($("#my_large_image").height()); // may be 0 because the image isn't available
});
$(window).load(function() {
console.log($("#my_large_image").height()); // will be correct
});
```

## 6

Using the document-ready event can have small [performance drawbacks](http://stackoverflow.com/q/9557846/938297), with delayed execution of up to ~300ms.
Sometimes the same behavior can be achieved by execution of code just before the closing `</body>` tag:

```html
<body>
<span id="greeting"></span> world!
<script>
$("#greeting").text("Hello");
</script>
</body>
```

will produce similar behavior but perform sooner than as it does not wait for the document ready event trigger as it
does in:

```html
<head>
<script>
jQuery(function($) {
$("#greeting").text("Hello");
});
</script>
</head>
<body>
<span id="greeting"></span> world!
</body>
```

Emphasis on the fact that first example relies upon your knowledge of your page and placement of the script just
prior to the closing `</body>` tag and specifically after the span tag.
