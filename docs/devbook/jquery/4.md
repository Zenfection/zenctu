# B√†i 4: document-ready event

## 1.Kh√°i ni·ªám v√† c√°ch s·ª≠ d·ª•ng

Code c·ªßa `jQuery` th∆∞·ªùng n·∫±m trong `(function($) { ... })` ƒë·ªÉ n√≥ ch·∫°y khi `DOM` t·∫£i ho√†n th√†nh.

```html:no-line-numbers
<script>
  jQuery(function($) {
    $("#myDiv").text("Hello");
    // t·∫•t c·∫£ th·∫ª c√≥ id="myDiv" ƒë·ªÅu thay ƒë·ªïi n·ªôi dung l√† "Hello"
  });
</script>
```


::: danger üö® C·∫¢NH B√ÅO

N·∫øu b·∫°n kh√¥ng c√≥ d√≤ng `function($){...}` th√¨ b·∫°n kh√¥ng th·ªÉ ch·ªçn ph·∫ßn t·ª≠ `DOM` v√¨ n√≥ ch∆∞a ƒë∆∞·ª£c t·∫£i nh∆∞ sau:

```html:no-line-numbers
<script>
  $("#myDiv").text("Hello");
  // th·ªùi ƒëi·ªÉm n√†y th√¨ id="myDiv" ch∆∞a ƒë∆∞·ª£c t·∫£i l√™n DOM
  // n√™n m·ªçi thao t√°c b·∫°n ƒë·ªÅu v√¥ hi·ªáu
</script>
```
:::

::: warning ‚ö†Ô∏è L∆ØU √ù

- B·∫°n c√≥ th·ªÉ ƒë·∫∑t b√≠ danh cho `jQuery` b·∫±ng h√†m `ready()`, r·∫•t h·ªØu d·ª•ng trong vi·ªác m·ªôt th∆∞ vi·ªán `JS` kh√°c s·ª≠ d·ª•ng `$` l√†m b√≠ danh.

- ƒê·ªÉ tr√°nh s·ª± xung ƒë·ªôt n√†y, b·∫°n ph·∫£i s·ª≠ d·ª•ng h√†m `$.noConflict()`, n√≥ ch·ªâ c√≥ th·ªÉ s·ª≠ d·ª•ng tr√™n kh√¥ng gian c·ªßa h√†m `jQuery`

```js:no-line-numbers
$.noConflict();
jQuery( document ).ready(function( $ ){
  // ta c√≥ th·ªÉ s·ª≠ d·ª•ng $ l√†m b√≠ danh 
  // m√† kh√¥ng xung ƒë·ªôt v·ªõi b√≠ danh c·ªßa th∆∞ vi·ªán kh√°c
  $('body').append('<div>Hello</div>')
})

jQuery( document ).ready(function( jq ) {
  //ta s·ª≠ d·ª•ng jq l√†m b√≠ danh c·ªßa jQuery
  jq('body').append('<div>Hello</div>')
});
```
:::

::: tip üí° M·∫∏O 

Thay v√¨ code `jQuery` ·ªü cu·ªëi trang, h√£y s·ª≠ d·ª•ng `$(document).ready(function(){...})`, ƒë·ªÉ ch·ªù ƒë·∫øn khi `DOM` t·∫£i xong r·ªìi code `jQuery` m·ªõi ƒë∆∞·ª£c th·ª±c thi
:::

## 2. C√°c phi√™n b·∫£n jQuery

### jQuery `1.8` v√† tr∆∞·ªõc ƒë√≥

`jQuery` ch·ªâ ch·∫°y khi t·∫•t c·∫£ c·∫•u tr√∫c `DOM` ƒë·ªÅu s·∫µn s√†ng

```js:no-line-numbers
$(function() {
  // code
});
```

```js:no-line-numbers
$().ready(function() {
  // code
});
```

```js:no-line-numbers
$(document).ready(function() {
  // code
});
```

::: tip üí° KHUY·∫æT KH√çCH

V√¨ c·∫£ 3 c√°ch tr√™n t∆∞∆°ng ƒë∆∞∆°ng nhau, n√™n c√°ch ƒë·∫ßu ti√™n ƒë∆∞·ª£c khuy·∫øt kh√≠ch s·ª≠ d·ª•ng t·ª´ kh√≥a `jQuery` thay cho `$`:

```js:no-line-numbers
jQuery(function() {
// code
});
```
:::

### jQuery `3.0` v·ªÅ sau

·ªû `jQuery 3.0` ƒë√¢y l√† m·∫´u khuy·∫øt kh√≠ch s·ª≠ d·ª•ng: 

```js:no-line-numbers
jQuery(function($) {
  // Ch·∫°y khi DOM s·∫µn s√†ng
  // ƒë·ªëi s·ªë $ (ƒë·∫ßu ti√™n) s·∫Ω tham chi·∫øu n·ªôi b·ªô ƒë·∫øn jQuery
  // kh√¥ng d·ª±a v√†o $ tham chi·∫øu t·ªõi jQuery trong global namespace
});
```

> Tham kh·∫£o [document-ready handlers trong jQuery 3.0](https://jquery.com/upgrade-guide/3.0/#deprecated-document-ready-handlers-other-than-jquery-function)

K·ªÉ t·ª´ `jQuery 3.0` tr·ªü ƒëi, `ready handler` s·∫Ω lu√¥n g·ªçi l√† [kh√¥ng ƒë·ªìng ƒë·ªô](https://jquery.com/upgrade-guide/3.0/#breaking-change-document-ready-handlers-are-now-asynchronous). V√≠ nh∆∞ nh∆∞ code d∆∞·ªõi ƒë√¢y

```js
$(function() {
  console.log("inside handler");
});
console.log("outside handler");
```

> outside handler
> 
> inside handler

==> `outside handler` s·∫Ω ƒë∆∞·ª£c in ra tr∆∞·ªõc b·∫•t k·ª≥ b·∫°n ƒë·ªÉ n√≥ ·ªü sau `$(function(){...})`

## 4. ƒê√≠nh k√®m events and thao t√°c `DOM` b√™n trong `ready()`

Example uses of $(document).ready():

### 1. ƒê√≠nh k√®m x·ª≠ l√Ω s·ª± ki·ªán

  ```js
  $(document).ready(function() {
    $("button").click(function() {
    // Th·ª±c thi khi click chu·ªôt v√†o
    });
  });
  ```

### 2. Ch·∫°y jQuery khi c·∫•u tr√∫c trang ƒë√£ t·∫°o 

```js
jQuery(function($) {
  // ƒê·∫∑t gi√° tr·ªã cho ph·∫ßn t·ª≠
  $("#myElement").val("Hello");
});
```

### 3. Thao t√°c v·ªõi c·∫•u tr√∫c `DOM` ƒë√£ t·∫£i

**V√ç D·ª§**: ·∫®n th·∫ª khi trang v·ª´a t·∫£i xong, v√† hi·ªán n√≥ khi click v√†o n√∫t *button*

```js
$(document).ready(function() {
  $("#toggleDiv").hide();
  $("button").click(function() {
    $("#toggleDiv").show();
  });
});
```

## 5.

`$(window).load()` ƒë√£ kh√¥ng ƒë∆∞·ª£c d√πng t·ª´ b·∫£n `1.8` v√† ho√†n to√†n lo·∫°i b·ªè t·ª´ `jQuery 3.0`

::: tip L√ù DO

- N√≥ kh√¥ng ho·∫°t ƒë·ªông nh·∫•t qu√°n v·ªõi m·ªçi tr√¨nh duy·ªát

- Kh√¥ng k√≠ch ho·∫°t ch√≠nh x√°c trong **WebKit** 

- Kh√¥ng s·ª≠ d·ª•ng c√¢y DOM ch√≠nh x√°c

- Ng·ª´ng k√≠ch ho·∫°t ƒë·ªëi v·ªõi h√¨nh ·∫£nh ƒë√£ n·∫±m trong b·ªô nh·ªõ tr√¨nh duy·ªát
:::

If you still wish to use load() it is documented below:

$(document).ready() waits until the full DOM is availble -- all the elements in the HTML have been parsed and are
in the document. However, resources such as images may not have fully loaded at this point. If it is important to
wait until all resources are loaded, $(window).load() and you're aware of the significant limitations of this
event then the below can be used instead:

```js
$(document).ready(function() {
  console.log($("#my_large_image").height()); // may be 0 because the image isn't available
});
$(window).load(function() {
  console.log($("#my_large_image").height()); // will be correct
});
```

## 6

Using the document-ready event can have small [performance drawbacks](http://stackoverflow.com/q/9557846/938297), with delayed execution of up to ~300ms.
Sometimes the same behavior can be achieved by execution of code just before the closing `</body>` tag:

```html
<body>
  <span id="greeting"></span> world!
  <script>
    $("#greeting").text("Hello");
  </script>
</body>
```

will produce similar behavior but perform sooner than as it does not wait for the document ready event trigger as it
does in:

```html
<head>
<script>
jQuery(function($) {
$("#greeting").text("Hello");
});
</script>
</head>
<body>
<span id="greeting"></span> world!
</body>
```

Emphasis on the fact that first example relies upon your knowledge of your page and placement of the script just
prior to the closing `</body>` tag and specifically after the span tag.
