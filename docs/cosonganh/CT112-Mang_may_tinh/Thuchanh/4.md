# Thá»±c hÃ nh buá»•i 4

::: tip ğŸ“ TÃ€I NGUYÃŠN

[Download tÃ i liá»‡u buá»•i 4](https://drive.google.com/uc?id=1yC_AMzdyaNDbFktZ4c_-FTfnK1b0Bt1z&export=view)
:::

## Kiáº¿n thá»©c

### Äá»‹nh tuyáº¿n ná»™i miá»n

- LÃ  nhÃ³m cÃ¡c máº¡ng `LAN` vÃ  `router` cÃ³ chung chÃ­nh sÃ¡ch quáº£n trá»‹.

- CÃ¡c giáº£i thuáº­t mÃ  `router` sá»­ dá»¥ng Ä‘á»ƒ váº¡ch Ä‘Æ°á»ng gá»i lÃ  `IGP` (*Interior GateWay Protocol*).

::: ğŸ’¡ tip Giáº£i thuáº­t <code>RIP</code> vÃ   <code>OSPF</code>

- `RIP` (*[Routing Information Protocol](https://en.wikipedia.org/wiki/Routing_Information_Protocol))*: sá»­ dá»¥ng giáº£i thuáº­t `Distance Vector` (*theo nguyÃªn lÃ½ [bellman-Ford](https://vi.wikipedia.org/wiki/Thu%E1%BA%ADt_to%C3%A1n_Bellman%E2%80%93Ford)*), phiÃªn báº£n `RIP` version **2**:

  1. ÄÆ¡n vá»‹ Ä‘o khoáº£ng cÃ¡ch dÃ¹ng trong váº¡ch Ä‘Æ°á»ng lÃ  `hops`

  2. Sá»‘ lÆ°á»£ng sá»‘ bÆ°á»›c nháº£y tá»‘i Ä‘a lÃ  `15`

  3. ChÃ¹ ká»³ cáº­p nháº­t báº£ng váº¡ch Ä‘Æ°á»ng lÃ  `30s` (*cÃ³ thá»ƒ tÃ¹y chá»‰nh*)

  4. Táº§ng váº­n chuyá»ƒn sá»­ dá»¥ng [UDP](https://vi.wikipedia.org/wiki/UDP) vá»›i cá»•ng lÃ  `520`

  5. Há»— trá»£ [CIDR](https://quantrimang.com/cidr-la-gi-165535) vÃ  [MD5](https://vi.wikipedia.org/wiki/MD5)

  ==> PhÃ¹ há»£p triá»ƒn khai trÃªn cÃ¡c **Ä‘á»‹nh tuyáº¿n ná»™i miá»n** cÃ³ kÃ­ch thÆ°á»›c nhá» vÃ  khÃ´ng phá»©c táº¡p

- `OSPF` (*[Open Shortest Path First](https://vi.wikipedia.org/wiki/OSPF)*): sá»­ dá»¥ng giáº£i thuáº­t `LSP` (*Link State Packet*) dá»±a trÃªn thuáº­t toÃ¡n [Dijkstra](https://vi.wikipedia.org/wiki/Thu%E1%BA%ADt_to%C3%A1n_Dijkstra), phiÃªn báº£n `OSPF` version **2**

  1. Há»™i tá»¥ nhanh vÃ  khÃ´ng cÃ³ tÃ¬nh tráº·ng láº·p vÃ´ táº­n viá»‡c váº¡ch Ä‘Æ°á»ng
  
  2. Há»— trá»£ máº¡ng kÃ­ch thÆ°á»›c lá»›n

  3. Há»— trá»£ [CIDR](https://quantrimang.com/cidr-la-gi-165535) vÃ  [MD5](https://vi.wikipedia.org/wiki/MD5)

  ==> PhÃ¹ há»£p triá»ƒn khai trÃªn cÃ¡c **Ä‘á»‹nh tuyáº¿n ná»™i miá»n** cÃ³ kÃ­ch thÆ°á»›c lá»›n vÃ  phá»©c táº¡p
:::

::: warning âš ï¸ LÆ¯U Ã

- Trong `kathara` Ä‘á»ƒ sá»­ dá»¥ng **Ä‘á»‹nh tuyáº¿n ná»™i miá»n** sá»­ dá»¥ng cÃ´ng cá»¥ cÃ³ sáºµn lÃ  `Quagga`: lÃ  dá»‹ch vá»¥ chá»©a cÃ¡c giáº£i thuáº­t váº¡ch Ä‘Æ°á»ng nhÆ° `RIPv2` vÃ  `OSPFv2` hoáº¡t Ä‘á»™ng tá»‘t trÃªn `IPv4`, `IPv6`...

- ÄÆ°á»£c cÃ i Ä‘áº·t táº¡i Ä‘Æ°á»ng dáº«n `/etc/quagga` trong mÃ¡y áº£o `Kathara`
:::

## 1. BÃ i táº­p 12

::: tip ğŸ’¡ MÃ” HÃŒNH

XÃ¢y dá»±ng há»‡ thá»‘ng máº¡ng vá»›i mÃ´ hÃ¬nh nhÆ° sau : 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/17-18-52-12-Screen%20Shot%202021-10-17%20at%2018.52.04.png">
:::

### Táº¡o thÆ° má»¥c vÃ  cÃ¡c file


```sh
mkdir ~/Desktop/BaiTap12
cd ~/Desktop/BaiTap12
mkdir router1 router2 router3 router4 
touch lab.conf router1.startup router2.startup router3.startup router4.startup
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/31-16-57-29-Screenshot%20from%202021-10-31%2014-36-10.png" width="500">

### Thiáº¿t láº­p cÃ¡c file

:::: tabs

  ::: tab lab.conf
  ```txt
  router1[0]=H
  router1[1]=G
  router1[2]=E
  router1[3]=A

  router2[0]=E
  router2[1]=F
  router2[2]=B

  router3[0]=F
  router3[1]=G
  router3[2]=I
  router3[3]=C

  router4[0]=D
  router4[1]=I
  router4[2]=H
  ```
  :::

  ::: tab router1.startup
  ```txt
  ifconfig eth0 100.1.0.13/30 up
  ifconfig eth1 100.1.0.9/30 up
  ifconfig eth2 100.1.0.1/30 up
  ifconfig eth3 100.1.1.1/24 up
  /etc/init.d/quagga start
  ```
  :::

  ::: tab router2.startup
  ```txt
  ifconfig eth0 100.1.0.2/30 up
  ifconfig eth1 100.1.2.1/24 up
  ifconfig eth2 100.1.2.1/24 up
  /etc/init.d/quagga start
  ```
  :::
  
  ::: tab router3.startup
  ```txt
  ifconfig eth0 100.1.0.6/30 up
  ifconfig eth1 100.1.0.10/30 up
  ifconfig eth2 100.1.0.17/30 up
  ifconfig eth3 100.1.3.1/24 up
  /etc/init.d/quagga start
  ```
  :::

  ::: tab router4.startup
  ```txt
  ifconfig eth0 100.1.4.1/24 up
  ifconfig eth1 100.1.0.18/30 up
  ifconfig eth2 100.1.0.14/30 up
  /etc/init.d/quagga start
  ```
  :::
::::

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/31-15-22-49-Screen%20Shot%202021-10-31%20at%2015.22.42.png" width="600">

::: tip ğŸ’¡ Giáº£i thÃ­ch

Lá»‡nh `etc/init.d/quagga start`: Ä‘á»ƒ khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥ `Quagga`
:::
### Cáº¥u hÃ¬nh `Quagga`

Trong má»—i thÆ° viá»‡n `router` hÃ£y táº¡o thÆ° má»¥c vÃ  cáº¥u hÃ¬nh nhÆ° sau : 

```txt-no:no-line-numbers
-- router1
   -- etc
      -- quagga
       + daemons
       + ripd.conf
       + zebra.conf
```

:::: tabs

  ::: tab daemons
  ```txt
  zebra=yes
  ripd=yes
  ```
  :::

  ::: tab zebra.conf
  ```txt
  hostname zebra
  password zebra
  enable password zebra
  log file /var/log/zebra/zebra.log
  ```
  :::

  ::: tab rip.conf
  ```txt
  hostname ripd
  password zebra
  enable password zebra

  router rip
  network 100.1.0.0/16
  redistribute connected
  log file /var/log/zebra/ripd.log
  ``` 
  :::
::::

::: tip ğŸ’¡ GIáº¢I THÃCH

- `zebra.conf`: chá»©a ná»™i dung miÃªu táº£ cho cÃ´ng cá»¥ `Quagga` nhÆ° : 
  
  1. username vÃ  password

  2. ÄÆ°á»ng dáº«n nháº­t kÃ½ (`log file`)

- `daemons`: chá»©a khai bÃ¡o cÃ¡c giao thá»©c váº¡ch Ä‘Æ°á»ng Ä‘Æ°á»£c `Quagga` há»— trá»£ nhÆ° :

  1. `RIPv2` trÃªn `IPv4`: Ä‘áº·t tÃªn lÃ  `ripd`

  2. `OSPFv2` trÃªn `IPv4`: Ä‘áº·t tÃªn lÃ  `ospfd`

  3. `BGP` trÃªn `IPv4` vÃ  `IPv6`: Ä‘áº·t tÃªn lÃ  `bgpd`

- `ripd.conf`: chá»©a ná»™i dung miÃªu táº£ hoáº¡t Ä‘á»™ng cá»§a giáº£i thuáº­t `RIPv2`

  1. Lá»‡nh `router rip`: cho biáº¿t router sáº½ sá»­ dá»¥ng `RIPv2` lÃ m váº¡ch Ä‘Æ°á»ng 

  2. Lá»‡nh `network`: lÃ  pháº¡m vi gá»­i vÃ  nháº­n gÃ³i tin, cÃ³ thá»ƒ sá»­ dá»¥ng `ip` khÃ¡c dÆ°á»›i `24`

  3. Lá»‡nh `redistribute connected`: cho phÃ©p router Ä‘Ã³ng gÃ³i cÃ¡c thÃ´ng tin vá» nhá»¯ng nhÃ¡nh máº¡ng 
:::

::: tip ğŸ’¡  Máº¸O

Sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ copy qua cÃ¡c router cÃ²n láº¡i 

```sh
cp -r router1/etc router2
cp -r router1/etc router3
cp -r router1/etc router4
```
:::

Sá»­ dá»¥ng lá»‡nh `tree` Ä‘á»ƒ xem cáº¥u trÃºc file (*cÃ i báº±ng lá»‡nh sau:* `sudo apt install tree`)

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/31-17-33-18-Screen%20Shot%202021-10-31%20at%2017.33.08.png" width="250">

### Khá»Ÿi Ä‘á»™ng mÃ¡y áº£o

Sá»­ dá»¥ng dá»¥ng lá»‡nh sau Ä‘á»ƒ khá»Ÿi táº¡o cÃ¡c mÃ¡y áº£o `Kathara` vá»«a khá»Ÿi táº¡o :

```sh
kathara lstart
```




<comment/>
