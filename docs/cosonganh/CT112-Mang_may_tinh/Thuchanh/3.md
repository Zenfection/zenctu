# Th·ª±c h√†nh bu·ªïi 3

[Download t√†i li·ªáu bu·ªïi 3](https://github.com/Zenfection/zenctu/raw/main/docs/cosonganh/CT112-Mang_may_tinh/Thuchanh/file/3.pdf)

## 1. B√†i t·∫≠p 8

::: tip üí° M√î H√åNH

Cho m√¥ h√¨nh nh∆∞ sau : 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-10-01-28-Screen%20Shot%202021-10-03%20at%2022.37.55.png" width="500">
:::

### T·∫°o th∆∞ m·ª•c v√† c√°c file

T·∫°o c√°c file v√† th∆∞ m·ª•c nh∆∞ h√¨nh b√™n d∆∞·ªõi : 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-10-06-00-Screenshot%20from%202021-10-04%2010-04-37.png">

B·∫±ng c√°ch th·ª±c hi·ªán c√°c l·ªánh sau: 

```sh
mkdir ~/Desktop/BaiTap8
cd ~/Desktop/BaiTap8
mkdir pc1 pc2 pc3 pc4 switch
touch pc1.startup pc2.startup pc3.startup pc4.startup switch.startup
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-10-09-06-Screen%20Shot%202021-10-04%20at%2010.09.01.png" width="600">

### Thi·∫øt l·∫≠p c√°c file

:::: tabs

  ::: tab lab.conf
  ```txt
  pc1[0]=A
  pc2[0]=B
  pc3[0]=C
  pc4[0]=D
  switch[0]=A
  switch[1]=B
  switch[2]=C
  switch[3]=D
  ```
  :::

  ::: tab pc1.startup
  ```txt
  ifconfig eth0 10.0.0.10/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:10
  ```
  :::

  ::: tab pc2.startup
  ```txt
  ifconfig eth0 10.0.0.20/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:20
  ```
  :::

  ::: tab pc3.startup
  ```txt
  ifconfig eth0 10.0.0.30/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:30
  ```
  :::

  ::: tab pc4.startup
  ```txt
  ifconfig eth0 10.0.0.40/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:40
  ```
  :::

  ::: tab switch.startup
  ```txt
  ifconfig eth0 up
  ifconfig eth0 hw ether 00:00:00:00:10:10
  ifconfig eth1 up
  ifconfig eth1 hw ether 00:00:00:00:20:20
  ifconfig eth2 up
  ifconfig eth2 hw ether 00:00:00:00:30:30
  ifconfig eth3 up
  ifconfig eth3 hw ether 00:00:00:00:40:40
  brctl addbr br0
  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2
  brctl addif br0 eth3
  brctl stp br0 on
  ifconfig br0 up
  ```
  :::
::::

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-11-06-51-4f3ba542094ec010995f.jpg">

::: tip ü§î GI·∫¢I TH√çCH

- Ch·ªâ s·ªë in <mark>m√†u v√†ng</mark> l√† ƒë·ªãa ch·ªâ v·∫≠t l√Ω

- `hw ether` l√† g·∫Øn ƒë·ªãa ch·ªâ `MAC` cho m·∫°ng

- Trong file `switch.startup` : 

  1. T·∫°o ra c·∫ßu n·ªëi t√™n l√† `br0` v√† n·ªëi ·ªü c√°c nh√°nh kh√°c nhau

  2. L·ªánh `addbr` : t·∫°o ra m·ªôt c·∫ßu n·ªëi n·ªëi (`br0`, `br1`...) ƒë·ªÉ n·ªëi nh√°nh `A`,`B`,`C` v√† `D` l·∫°i

  3. L·ªánh `addif` : ƒêƒÉng k√Ω c√°c c·ªïng c·ªßa `switch` ·∫£o v√† c·∫ßu n·ªëi. C√°c c·ªïng thu·ªôc chung 1 c·∫ßu n·ªëi th√¨ truy·ªÅn d·ªØ li·ªáu cho nhau

  4. L·ªánh `stp <name_of_bridge>` : K√≠ch ho·∫°t gi·∫£i thu·∫≠t `STP` tr√™n m·ªôt c·∫ßu n·ªëi c·ªßa `switch` ·∫£o

  5. L·ªánh `ifconfig <name_of_bridge>` : K√≠ch ho·∫°t c·∫ßu n·ªëi (`br0`, `br1`...)
:::


### Kh·ªüi t·∫°o h·ªá th·ªëng m√°y ·∫£o

S·ª≠ d·ª•ng l·ªánh `Kathara` sau : 

```sh
kathara lstart pc1 pc2 pc3 pc4 switch
```

Tr√™n thi·∫øt b·ªã `switch` s·ª≠ d·ª•ng `MAC Lookup Table` b·∫±ng l·ªánh sau : 

```sh
brctl showmacs br0
```

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-10-55-01-Screenshot%20from%202021-10-04%2010-54-32.png">

Tr√™n m√°y ·∫£o `pc1`, `pc3`, `switch` th·ª±c hi·ªán l·ªánh `tcpdump` nh∆∞ sau :

:::: tabs

  ::: tab pc1
  ```sh
  tcpdump -e -q -w /shared/BT8_pc1.pcap
  ```
  :::
  
  ::: tab pc2
  ```sh
  tcpdump -e -q -w /shared/BT8_pc2.pcap
  ```
  :::
  
  ::: tab switch
  ```sh
  tcpdump -e -q -w /shared/BT8_switch.pcap
  ```
  :::
::::

::: tip ü§î GI·∫¢I TH√çCH

- `-e` : Thay v√¨ hi·ªÉn th·ªã ƒë·ªãa ch·ªâ `IP` s·∫Ω ƒë∆∞·ª£c thay th·∫ø b·∫±ng ƒë·ªãa ch·ªâ `MAC`

- `-q` : Hi·ªÉn th·ªã √≠t th√¥ng tin h∆°n

- `-w` : Xu·∫•t file ra ƒë∆∞·ªùng d·∫´n c·ª• th·ªÉ
:::

T·ª´ `pc2` th·ª±c hi·ªán ping t·ªõi `pc3` b·∫±ng l·ªánh `ping 10.0.0.30 -c 10`

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-11-42-42-Screen%20Shot%202021-10-04%20at%2011.42.31.png">

Th·ª±c hi·ªán g√µ l·∫°i l·ªánh `brctl showmacs br0` tr√™n `switch` v√† xem kh√°c bi·ªát : 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-11-44-44-Screenshot%20from%202021-10-04%2011-44-00.png">

::: tip üí° NH·∫¨N X√âT

Sau khi s·ª≠ d·ª•ng l·ªánh `ping` t·ª´ `switch` ƒë√£ s√†n l·ªçc l·∫°i c√°c ƒë·ªãa ch·ªâ v·∫≠t l√Ω c·ªßa c√°c m√°y hi·ªán c√≥ v√† c·∫≠p nh·∫≠t n√≥ v√†o trong `MAC Lookup Table`
:::

### Ph√¢n t√≠ch g√≥i pcap tr√™n WireShark

Trong th∆∞ m·ª•c `shared` ·ªü `BaiTap8`, c√≥ ch·ª©a c√°c file `.pcap` ƒë√£ ƒë∆∞·ª£c ph√¢n t√≠ch tr∆∞·ªõc ƒë√≥

#### H√£y m·ªü file `BT8_switch.pcap` b·∫±ng `WireShark`: 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-12-55-11-Screenshot%20from%202021-10-04%2012-54-43.png">

##### Ch·ªçn khung giao di·ªán c√≥ giao th·ª©c `ARP` ƒë·∫øn t·ª´ ƒë·ªãa ch·ªâ `MAC` : `00:00:00:00:00:20`

> Tr√™n h√¨nh l√† khung s·ªë `8`

::: tip üí° NH·∫¨N X√âT

- `Switch` nh·∫≠n ƒë∆∞·ª£c khung d·ªØ li·ªáu n√†y v√¨ `pc2` ƒë√£ **ping** t·ªõi `pc3`. `pc2` truy·ªÅn th√¥ng ƒëi·ªáp t·ªõi `switch` ƒë·ªÉ t√¨m ƒë·ªãa ch·ªâ `MAC` c·ªßa `pc3`

- Khung d·ªØ li·ªáu n√†y c√≥ √Ω nghƒ©a `switch` ƒë√£ nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu t√¨m ƒë·ªãa ch·ªâ v·∫≠t l√Ω c·ªßa `pc3` m√† `pc2` g·ª≠i t·ªõi
:::

##### Ch·ªçn khung giao di·ªán c√≥ giao th·ª©c `ARP` ƒë·∫øn t·ª´ ƒë·ªãa ch·ªâ `MAC` : `00:00:00:00:00:30`

> Tr√™n h√¨nh l√† khung s·ªë `9`

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-12-59-03-Screen%20Shot%202021-10-04%20at%2012.58.53.png">


::: tip üí° NH·∫¨N X√âT

- `Switch` nh·∫≠n ƒë∆∞·ª£c khung d·ªØ li·ªáu n√†y v√¨ ƒë√£ t√¨m th·∫•y ƒë∆∞·ª£c ƒë·ªãa ch·ªâ v·∫≠t l√Ω c·ªßa `pc3`

- Khung d·ªØ li·ªáu n√†y c√≥ √Ω nghƒ©a l√† `switch` ƒë√£ g·ª≠i ƒë·ªãa ch·ªâ v·∫≠t l√Ω c·ªßa `pc3` t·ªõi `pc2`
:::

#### M·ªü file `BT8_pc1.pcap` b·∫±ng `WireShark`

##### Ch·ªçn khung d·ªØ li·ªáu c√≥ giao th·ª©c `ARP` ƒë·∫øn t·ª´ ƒë·ªãa ch·ªâ MAC `00:00:00:00:00:20`

> Tr√™n h√¨nh l√† khung `43`

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-13-03-30-Screen%20Shot%202021-10-04%20at%2013.03.25.png">

::: tip üí° NH·∫¨N X√âT

- `pc1` nh·∫≠n ƒë∆∞·ª£c d·ªØ li·ªáu n√†y v√¨ `switch` truy·ªÅn qu·∫£ng b√° khung d·ªØ li·ªáu ra t·∫•t c·∫£ c√°c c·ªïng ƒë·ªÉ t√¨m ƒë∆∞·ª£c ƒë·ªãa ch·ªâ v·∫≠t l√Ω c·ªßa `pc3`

- Khung d·ªØ li·ªáu n√†y c√≥ √Ω nghƒ©a `pc1` s·∫Ω kh√¥ng h·ªìi ƒë√°p v√¨ `10.0.0.30` kh√¥ng ph·∫£i l√† IP c·ªßa `pc1`
:::

#### M·ªü file `BT8_pc3.pcap` b·∫±ng `WireShark`

##### Ch·ªçn khung d·ªØ li·ªáu c√≥ giao th·ª©c `ARP` ƒë·∫øn t·ª´ ƒë·ªãa ch·ªâ MAC `00:00:00:00:00:20`

> Tr√™n h√¨nh l√† khung `30`

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-13-07-25-Screen%20Shot%202021-10-04%20at%2013.07.17.png">

::: tip üí° NH·∫¨N X√âT

- `pc3` nh·∫≠n ƒë∆∞·ª£c khung n√†y v√¨ `switch` truy·ªÅn b√° khung d·ªØ li·ªáu ra t·∫•t c·∫£ c√°c c·ªïng ƒë·ªÉ t√¨m ƒë·ªãa ch·ªâ v·∫≠t l√Ω c·ªßa `pc3`

- `pc3` s·∫Ω ph·∫£n h·ªìi khung n√†y, v√¨ ƒë·ªãa ch·ªâ c·ªßa `pc3` l√† `10.0.0.30` kh·ªõp v·ªõi ƒë·ªãa ch·ªâ `switch` ƒëang t√¨m ki·∫øm
:::

---

::: tip üìù K·∫æT LU·∫¨N

- Sau khi th·ª±c hi·ªán `ping` gi·ªØa 2 m√°y ·∫£o c√≥ c√πng `switch` th√¨ `switch` s·∫Ω truy·ªÅn d·ªØ li·ªáu t√¨m ki·∫øm ƒë·∫øn t·∫•t c·∫£ c√°c thi·∫øt b·ªã ƒë∆∞·ª£c `switch` n·ªëi k·∫øt trong c√πng m·∫°ng `LAN`

- Sau ƒë√≥ `switch` **h·ªçc** ƒë∆∞·ª£c ƒë·ªãa ch·ªâ v·∫≠t l√Ω c·ªßa c√°c m√°y t√≠nh ƒë√≥ v√† c·∫≠p nh·∫≠t v√†o trong `MAC Lookup Table`
:::

### Hu·ª∑ h·ªá th·ªëng m√°y ·∫£o

S·ª≠ d·ª•ng l·ªánh sau ƒë·ªÉ hu·ª∑ h·ªá th·ªëng m√°y ·∫£o v·ª´a t·∫°o : 

```sh
kathara wipe
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-13-13-37-Screen%20Shot%202021-10-04%20at%2013.13.33.png" width="600">

## 2. B√†i t·∫≠p 9

::: tip üí° M√î H√åNH

X√¢y d·ª•ng m√¥ h√¨nh m·∫°ng nh∆∞ sau : 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-13-14-34-Screen%20Shot%202021-10-04%20at%2013.14.27.png">
:::

### T·∫°o th∆∞ m·ª•c v√† c√°c file

T·∫°o c√°c th∆∞ m·ª•c theo m√¥ h√¨nh nh∆∞ sau : 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-15-08-05-Screenshot%20from%202021-10-04%2015-07-25.png">

B·∫±ng c√°ch s·ª≠ d·ª•ng c√°c l·ªánh sau : 

```sh
mkdir ~/Desktop/BaiTap9
cd ~/Desktop/BaiTap9
mkdir pc1 pc2 pc3 pc4 pc5 pc6 pc7 pc8 switch1 switch2
touch lab.conf pc1.startup pc2.startup pc3.startup pc4.startup pc5.startup pc6.startup pc7.startup pc8.startup switch1.startup switch2.startup
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-15-06-38-Screen%20Shot%202021-10-04%20at%2015.06.31.png">

### Thi·∫øt l·∫≠p c√°c file

:::: tabs

  ::: tab lab.conf 
  ```txt
  pc1[0]=A
  pc2[0]=B
  pc3[0]=C
  pc4[0]=D
  pc5[0]=E
  pc6[0]=F
  pc7[0]=G
  pc8[0]=H
  switch1[0]=A
  switch1[1]=B
  switch1[2]=C
  switch1[3]=D
  switch1[4]=K
  switch2[0]=E
  switch2[1]=F
  switch2[2]=G
  switch2[3]=H
  switch2[4]=K
  ```
  :::

  ::: tab pc1.startup
  ```txt
  ifconfig eth0 10.0.0.10/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:10
  ```
  :::

  ::: tab pc2.startup
  ```txt
  ifconfig eth0 10.0.0.20/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:20
  ```
  :::

  ::: tab pc3.startup
  ```txt
  ifconfig eth0 10.0.0.30/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:30
  ```
  :::

  ::: tab pc4.startup
  ```txt
  ifconfig eth0 10.0.0.40/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:40
  ```
  :::

  ::: tab pc5.startup
  ```txt
  ifconfig eth0 10.0.0.11/24 up
  ifconfig eth0 hw ether 00:00:00:00:77:10
  ```
  :::

  ::: tab pc6.startup
  ```txt
  ifconfig eth0 10.0.0.22/24 up
  ifconfig eth0 hw ether 00:00:00:00:77:20
  ```
  :::

  ::: tab pc7.startup
  ```txt
  ifconfig eth0 10.0.0.33/24 up
  ifconfig eth0 hw ether 00:00:00:00:77:30
  ```
  :::

  ::: tab pc8.startup
  ```txt
  ifconfig eth0 10.0.0.44/24 up
  ifconfig eth0 hw ether 00:00:00:00:77:40
  ```
  :::

  ::: tab switch1.startup
  ```txt
  ifconfig eth0 up
  ifconfig eth0 hw ether 00:00:00:00:10:10
  ifconfig eth1 up
  ifconfig eth1 hw ether 00:00:00:00:20:20
  ifconfig eth2 up
  ifconfig eth2 hw ether 00:00:00:00:30:30
  ifconfig eth3 up
  ifconfig eth3 hw ether 00:00:00:00:40:40
  ifconfig eth4 up
  ifconfig eth4 hw ether 00:00:00:00:50:50
  brctl addbr br0
  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2
  brctl addif br0 eth3  
  brctl addif br0 eth4
  brctl stp br0 on
  ifconfig br0 up  
  ```
  :::

  ::: tab switch2.startup
  ```txt
  ifconfig eth0 up 
  ifconfig eth0 hw ether 00:00:00:00:88:10
  ifconfig eth1 up
  ifconfig eth1 hw ether 00:00:00:00:88:20
  ifconfig eth2 up
  ifconfig eth2 hw ether 00:00:00:00:88:30
  ifconfig eth3 up
  ifconfig eth3 hw ether 00:00:00:00:88:40
  ifconfig eth4 up
  ifconfig eth4 hw ether 00:00:00:00:88:50
  brctl addbr br0
  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2
  brctl addif br0 eth3
  brctl addif br0 eth4
  brctl stp br0 on
  ifconfig br0 up
  ```
  :::
::::

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-16-53-04-49186767646fad31f47e.jpg">

### Kh·ªüi t·∫°o h·ªá th·ªëng m√°y ·∫£o

S·ª≠ d·ª•ng l·ªánh `kathara` sau ƒë·ªÉ kh·ªüi th·ªông h·ªá th·ªëng m√°y ·∫£o

```sh
kathara lstart pc1 pc2 pc3 pc4 pc5 pc6 pc7 pc8 switch1 switch2
```

::: warning ‚ö†Ô∏è L∆ØU √ù

N·∫øu xu·∫•t hi·ªán l·ªói g√¨ tr∆∞·ªõc d√≤ng `End Startup Commands Log`, th√¨ ki·ªÉm tra l·∫°i file c·∫•u h√¨nh c√≥ ƒë√∫ng kh√¥ng
:::

Ki·ªÉm tra **MAC Lookup Table** cho `switch1` v√† `switch2` b·∫±ng l·ªánh sau: 

```sh
brctl showmacs br0
```

| <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-16-58-07-Screenshot%20from%202021-10-04%2016-56-30.png"> | <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-16-58-09-Screenshot%20from%202021-10-04%2016-56-39.png"> |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

#### Tr√™n m√°y ·∫£o `switch1` v√† `switch2` th·ª±c hi·ªán l·ªánh `tcpdump` nh∆∞ sau:

:::: tabs

  ::: tab switch1
  ```sh
  tcpdump -e -q -w /shared/BT9_switch1.pcap
  ```
  :::

  ::: tab switch2
  ```sh
  tcpdump -e -q -w /shared/BT9_switch2.pcap
  ```
  :::
::::

Sau ƒë√≥ d·ª´ng `switch1` v√† `switch2` b·∫±ng l·ªánh `CTRL+C`

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-17-35-11-Screen%20Shot%202021-10-04%20at%2017.34.55.png">

S·ª≠ d·ª•ng l·∫°i l·ªánh `brctl showmacs br0` cho `switch1` v√† `switch2` ƒë·ªÉ xem s·ª± kh√°c bi·ªát 

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-17-49-07-9aa686093201fb5fa210.jpg">

::: tip üí° NH·∫¨N X√âT

- `switch1` h·ªçc ƒë·ªãa ch·ªâ c·ªßa `pc1` v√† `pc4`

- `switch2` ch·ªâ h·ªçc ƒë∆∞·ª£c ƒë·ªãa ch·ªâ c·ªßa `pc1`, (v√¨ `pc1` ping t·ªõi `pc4`), ƒë∆∞·ªùng ƒëi n√†y kh√¥ng qua n·ªëi k·∫øt ƒë·∫øn `LAN` trong `switch2`

- `pc5`, `pc6`, `pc7`, `pc8` c√≥ nh·∫≠n ƒë∆∞·ª£c g√≥i tin `ICMP` ƒë·∫øn t·ª´ `pc1`
:::

#### Tr√™n m√°y ·∫£o `switch1` v√† `switch2` th·ª±c hi·ªán l·ªánh `tcpdump` nh∆∞ sau:

:::: tabs

  ::: tab switch1
  ```sh
  tcpdump -e -q -w /shared/BT9_switch1_B.pcap
  ```
  :::

  ::: tab switch2
  ```sh
  tcpdump -e -q -w /shared/BT9_switch2_B.pcap
  ```
  :::
::::

T·ª´ `pc2` ping t·ªõi `pc7` b·∫±ng l·ªánh sau : 

```sh
ping 10.0.0.33 -c 10
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-18-07-54-Screen%20Shot%202021-10-04%20at%2018.07.44.png">

G√µ l·∫°i l·ªánh `brctl showmacs br0` cho thi·∫øt b·ªã `switch1` v√† `switch2`

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-18-09-36-Screen%20Shot%202021-10-04%20at%2018.09.25.png">

::: tip üí° NH·∫¨N X√âT

- `switch1` ch·ªâ h·ªçc ƒë∆∞·ª£c ƒë·ªãa ch·ªâ c·ªßa m√°y `pc2`

- `switch2` ch·ªâ h·ªçc ƒë∆∞·ª£c ƒë·ªãa ch·ªâ c·ªßa m√°y `pc2`

- `pc5`, `pc6`, `pc7`, `pc8` c√≥ nh·∫≠n ƒë∆∞·ª£c g√≥i tin t·ª´ `pc2`
:::

---

::: tip üìù K·∫æT LU·∫¨N

- N·∫øu ping gi·ªØa 2 m√°y kh√°c nhau kh√°c nh√°nh m·∫°ng `LAN`

- `Switch` nh·∫≠n ƒë∆∞·ª£c ƒë·ªãa ch·ªâ v·∫≠t l√Ω c·ªßa m√°y t√≠nh thu·ªôc c√πng nh√°nh m·∫°ng ƒë√≥ ho·∫∑c kh√°c nh√°nh
:::

### Hu·ª∑ h·ªá th·ªëng m√°y ·∫£o

S·ª≠ d·ª•ng l·ªánh sau ƒë·ªÉ hu·ª∑ h·ªá th·ªëng m√°y ·∫£o v·ª´a t·∫°o : 

```sh
kathara wipe
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-18-16-09-Screen%20Shot%202021-10-04%20at%2018.16.02.png" width="600">

## 3. B√†i t·∫≠p 10

::: tip üí° M√î H√åNH

X√¢y d·ª±ng m√¥ h√¨nh sau : 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/04-18-19-00-Screen%20Shot%202021-10-04%20at%2018.18.54.png" width="500">
:::

### T·∫°o th∆∞ m·ª•c v√† c√°c file

T·∫°o c√°c th∆∞ m·ª•c theo m√¥ h√¨nh nh∆∞ sau :

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-11-22-52-Screenshot%20from%202021-10-05%2011-21-29.png">

```sh
mkdir ~/Desktop/BaiTap10
cd ~/Desktop/BaiTap10
mkdir pc1 pc2 pc3 pc4 switch1 switch2 router
touch lab.conf pc1.startup pc2.startup pc3.startup pc4.startup switch1.startup switch2.startup router.startup
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-11-21-10-Screen%20Shot%202021-10-05%20at%2011.21.00.png" width="600">

### Thi·∫øt l·∫≠p c√°c file

::: warning ‚ö†Ô∏è L∆ØU √ù

V√¨ m√¥ h√¨nh kh√¥ng c√≥ IP tƒ©nh v√† c√°c t√™n nh√°nh m·∫°ng s·∫µn n√™n ta ph·∫£i t·ª± ƒëi·ªÅn, tham kh·∫£o nh∆∞ sau :

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-11-44-10-Screen%20Shot%202021-10-05%20at%2011.39.10.png" width="500">
:::

:::: tabs

  ::: tab lab.conf
  ```txt
  pc1[0]=A
  pc2[0]=B
  pc3[0]=D
  pc4[0]=E
  switch1[0]=A
  switch1[1]=B
  switch1[2]=C
  switch2[0]=D
  switch2[1]=E
  switch2[2]=F
  router[0]=C
  router[1]=F
  ```
  :::

  ::: tab pc1.startup
  ```txt
  ifconfig eth0 192.168.10.10/24 up
  route add default gw 192.168.10.1
  ```
  :::

  ::: tab pc2.startup
  ```txt
  ifconfig eth0 192.168.10.11/24 up
  route add default gw 192.168.10.1
  ```
  :::

  ::: tab pc3.startup
  ```txt
  ifconfig eth0 192.168.11.10/24 up
  route add default gw 192.168.11.1
  ```
  :::

  ::: tab pc4.startup
  ```txt
  ifconfig eth0 192.168.11.11/24 up
  route add default gw 192.168.11.1
  ```
  :::

  ::: tab switch1.startup
  ```txt
  ifconfig eth0 up
  ifconfig eth1 up
  ifconfig eth2 up
  brctl addbr br0
  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2
  brctl stp br0 on
  ifconfig br0 up
  ```
  :::

  ::: tab switch2.startup
  ```txt
  ifconfig eth0 up
  ifconfig eth1 up
  ifconfig eth2 up
  brctl addbr br0
  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2
  brctl stp br0 on
  ifconfig br0 up
  ```
  :::

  ::: tab router.startup
  ```txt
  ifconfig eth0 192.168.10.1/24 up
  ifconfig eth1 192.168.11.1/24 up
  ```
  :::
::::

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-12-36-05-Screen%20Shot%202021-10-05%20at%2012.35.57.png">

### Kh·ªüi t·∫°o h·ªá th·ªëng m√°y ·∫£o

S·ª≠ d·ª•ng l·ªánh `kathara` sau ƒë·ªÉ kh·ªüi ch·∫°y thi·∫øt b·ªã m√°y ·∫£o v·ª´a t·∫°o :

```sh
kathara lstart pc1 pc2 pc3 pc4 router switch1 switch2
```

::: tip üí° M·∫∏O

H√£y ch·∫Øc r·∫±ng c√°c thi·∫øt b·ªã c·ªßa b·∫°n ƒë·ªÅu ch√≠nh x√°c, h√£y ki·ªÉm tra `Startup Commands Log` tr√™n t·ª´ng thi·∫øt b·ªã xem c√≥ c√°i n√†y b·ªã l·ªói hay kh√¥ng
:::

S·ª≠ d·ª•ng l·ªánh `brctl showmacs br0` cho `switch1` v√† `switch2` 

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-12-37-21-Screen%20Shot%202021-10-05%20at%2012.37.12.png">

S·ª≠ d·ª•ng l·ªánh `tcpdump` sau l·∫ßn l∆∞·ª£t cho `switch1` v√† `switch2` nh∆∞ sau :

:::: tabs

  ::: tab switch1
  ```txt
  tcpdump -e -q -w /shared/BT10_swtich1.pcap
  ```
  :::

  ::: tab switch2
  ```txt
  tcpdump -e -q -w /shared/BT10_switch2.pcap
  ```
  :::
::::

Sau ƒë√≥ t·ª´ `pc1` s·ª≠ d·ª•ng l·ªánh ping t·ªõi `pc2`, `pc3` v√† `pc4` nh∆∞ sau:

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-12-41-00-Screen%20Shot%202021-10-05%20at%2012.40.19.png">

S·ª≠ d·ª•ng l·∫°i l·ªánh `brctl showmacs br0` cho `switch1` v√† `switch2` ƒë·ªÉ xem l·∫°i c·∫≠p nh·∫≠t **MAC Lookup Table**

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-12-42-28-Screen%20Shot%202021-10-05%20at%2012.42.20.png">

> C√°c ƒë·ªãa ch·ªâ v·∫≠t l√Ω `ip` c·ªßa nhi·ªÅu thi·∫øt b·ªã ƒë√£ ƒë∆∞·ª£c c√°c `switch` h·ªçc khi s·ª≠ d·ª•ng `ping` t·ªõi t·ª´ng thi·∫øt b·ªã

### Hu·ª∑ h·ªá th·ªëng m√°y ·∫£o

S·ª≠ d·ª•ng l·ªánh sau ƒë·ªÉ hu·ª∑ h·ªá th·ªëng m√°y ·∫£o :

```sh
kathara wipe
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-12-44-56-Screen%20Shot%202021-10-05%20at%2012.44.43.png" width="600">

## 4. B√†i t·∫≠p 11

::: tip üí° M√î H√åNH

X√¢y d·ª±ng m√¥ h√¨nh nh∆∞ sau :

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-12-57-15-Screen%20Shot%202021-10-05%20at%2012.57.06.png">
:::

### T·∫°o th∆∞ m·ª•c v√† c√°c file

T·∫°o c√°c file v√† th∆∞ m·ª•c theo m√¥ h√¨nh sau :

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-14-04-44-Screenshot%20from%202021-10-05%2013-01-17.png">

B·∫±ng c√°ch s·ª≠ d·ª•ng c√°c l·ªánh sau : 

```sh
mkdir ~/Desktop/BaiTap10
cd ~/Desktop/BaiTap10
mkdir pc1 pc2 pc3 pc4 pc5 pc6 pc7 pc8 switch1 switch2 switch3 switch4 router1 router2
touch lab.conf pc1.startup pc2.startup pc3.startup pc4.startup pc5.startup pc6.startup pc7.startup pc8.startup switch1.startup switch2.startup switch3.statup switch4.startup router1.startup router2.startup
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-13-01-00-Screen%20Shot%202021-10-05%20at%2013.00.53.png" width="600">

### Thi·∫øt l·∫≠p c√°c file

::: warning ‚ö†Ô∏è L∆ØU √ù

Tr∆∞·ªõc h·∫øt ta ph·∫£i l·∫≠p ra t√™n c√°c nh√°nh m·∫°ng nh∆∞ sau : 

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-14-39-05-Screen%20Shot%202021-10-05%20at%2014.11.19.png">
:::

S·ª≠ d·ª•ng `gedit` ƒë·ªÉ thi·∫øt l·∫≠p c√°c file nh∆∞ sau :

> lab.conf

```txt
pc1[0]=A
pc2[0]=B
pc3[0]=C
pc4[0]=D
pc5[0]=G
pc6[0]=H
pc7[0]=I
pc8[0]=J

switch1[0]=A
switch1[1]=B
switch1[2]=E

switch2[0]=C
switch2[1]=D
switch2[2]=F

switch3[0]=G
switch3[1]=H
switch3[2]=K

switch4[0]=I
switch4[1]=J
switch4[2]=O

router1[0]=E
router1[1]=F
router1[2]=M

router2[0]=K
router2[1]=O
router2[2]=M
```

:::: tabs 
  
  ::: tab pc1.startup
  ```txt
  ifconfig eth0 192.168.10.10/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:10
  route add default gw 192.168.10.1
  ``` 
  :::

  ::: tab pc2.startup
  ```txt
  ifconfig eth0 192.168.10.11/24 up
  ifconfig eth0 hw ether 00:00:00:00:00:20
  route add default gw 192.168.10.1
  ``` 
  :::

  ::: tab pc3.startup
  ```txt
  ifconfig eth0 192.168.11.10/24 up
  ifconfig eth0 hw ether 00:00:00:00:11:10
  route add default gw 192.168.11.1
  ``` 
  :::

  ::: tab pc4.startup
  ```txt
  ifconfig eth0 192.168.11.11/24 up
  ifconfig eth0 hw ether 00:00:00:00:10:20
  route add default gw 192.168.11.1
  ``` 
  :::

  ::: tab pc5.startup
  ```txt
  ifconfig eth0 192.168.20.10/24 up
  ifconfig eth0 hw ether 00:00:00:00:22:10
  route add default gw 192.168.20.1
  ``` 
  :::

  ::: tab pc6.startup
  ```txt
  ifconfig eth0 192.168.20.11/24 up
  ifconfig eth0 hw ether 00:00:00:00:22:20
  route add default gw 192.168.20.1
  ``` 
  :::

  ::: tab pc7.startup
  ```txt
  ifconfig eth0 192.168.21.10/24 up
  ifconfig eth0 hw ether 00:00:00:00:33:10
  route add default gw 192.168.21.1
  ``` 
  :::

  ::: tab pc8.startup
  ```txt
  ifconfig eth0 192.168.21.10/24 up
  ifconfig eth0 hw ether 00:00:00:00:33:20
  route add default gw 192.168.21.1
  ``` 
  :::
::::

:::: tabs

  ::: tab switch1.startup
  ```txt
  ifconfig eth0 up
  ifconfig eth0 hw ether 00:00:00:00:10:10
  ifconfig eth1 up
  ifconfig eth1 hw ether 00:00:00:00:10:20
  ifconfig eth2 up
  ifconfig eth2 hw ether 00:00:00:00:10:30
  
  brctl addbr br0
  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2
  brctl stp br0 on
  ifconfig br0 up
  ```
  :::

  ::: tab switch2.startup
  ```txt
  ifconfig eth0 up
  ifconfig eth0 hw ether 00:00:00:00:88:10
  ifconfig eth1 up
  ifconfig eth1 hw ether 00:00:00:00:88:20
  ifconfig eth2 up
  ifconfig eth2 hw ether 00:00:00:00:88:30
  
  brctl addbr br0
  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2
  brctl stp br0 on
  ifconfig br0 up
  ```
  :::

  ::: tab switch3.startup
  ```txt
  ifconfig eth0 up
  ifconfig eth0 hw ether 00:00:00:00:20:10
  ifconfig eth1 up
  ifconfig eth1 hw ether 00:00:00:00:20:20
  ifconfig eth2 up
  ifconfig eth2 hw ether 00:00:00:00:20:30
  
  brctl addbr br0
  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2
  brctl stp br0 on
  ifconfig br0 up
  ```
  :::

  ::: tab switch4.startup
  ```txt
  ifconfig eth0 up
  ifconfig eth0 hw ether 00:00:00:00:44:10
  ifconfig eth1 up
  ifconfig eth1 hw ether 00:00:00:00:44:20
  ifconfig eth2 up
  ifconfig eth2 hw ether 00:00:00:00:44:30
  
  brctl addbr br0
  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2
  brctl stp br0 on
  ifconfig br0 up
  ```
  :::

  ::: tab router1.startup
  ```txt
  ifconfig eth0 192.168.10.1/24 up
  ifconfig eth1 192.168.11.1/24 up
  ifconfig eth2 10.0.0.1/30 up
  route add -net 192.168.20.0/24 gw 10.0.0.2
  route add -net 192.168.21.0/24 gw 10.0.0.2
  ```
  :::

  ::: tab router2.startup
  ```txt
  ifconfig eth0 192.168.21.1/24 up
  ifconfig eth1 192.168.20.1/24 up
  ifconfig eth2 10.0.0.2/30 up
  route add -net 192.168.10.0/24 gw 10.0.0.1
  route add -net 192.168.11.0/24 gw 10.0.0.1
  ```
  :::
::::

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-15-04-01-Screen%20Shot%202021-10-05%20at%2015.03.54.png">
>
> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-15-07-58-Screen%20Shot%202021-10-05%20at%2015.07.54.png">

### Kh·ªüi t·∫°o h·ªá th·ªëng m√°y ·∫£o

S·ª≠ d·ª•ng l·ªánh `kathara` sau d·ªÉ kh·ªüi t·∫°o m√°y ·∫£o :

```sh
kathara lstart pc1 pc2 pc3 pc4 pc5 pc6 pc7 pc8 switch1 switch2 switch3 switch4 router1 router2
```

::: tip üí° M·∫∏O

H√£y ch·∫Øc r·∫±ng c√°c thi·∫øt b·ªã c·ªßa b·∫°n ƒë·ªÅu ch√≠nh x√°c, h√£y ki·ªÉm tra `Startup Commands Log` tr√™n t·ª´ng thi·∫øt b·ªã xem c√≥ c√°i n√†y b·ªã l·ªói hay kh√¥ng
:::

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-15-27-18-Screen%20Shot%202021-10-05%20at%2015.27.03.png">

### Hu·ª∑ h·ªá th·ªëng m√°y ·∫£o

S·ª≠ d·ª•ng l·ªánh sau ƒë·ªÉ hu·ª∑ m√°y ·∫£o :

```sh
kathara wipe
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/10/05-15-22-09-Screen%20Shot%202021-10-05%20at%2015.22.05.png" width="600">

<comment/>
