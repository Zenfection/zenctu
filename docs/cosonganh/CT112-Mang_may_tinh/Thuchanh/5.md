# Thá»±c hÃ nh buá»•i 5

::: tip ğŸ“ Äá»€ BÃ€I

<div class="pdfZen">
  <iframe src="https://drive.google.com/file/d/1mPP6ZO6n-F_L1N2NykTZqq-8acGWFAJm/preview"></iframe>
</div>
:::

::: warning âš ï¸ LÆ¯U Ã

LÆ°á»£c bá»›t bÃ i `16` vÃ  `17` vÃ¬ cÃ³ thá»ƒ nÃ³ quÃ¡ khÃ³ !!!
:::

## 1.Kiáº¿n thá»©c

### Giao thá»©c `HTTP`

`Hyper Text Transfer Protocol` (*[HTTP](https://vi.wikipedia.org/wiki/Hypertext_Transfer_Protocol)*) lÃ  má»™t giao thá»©c trong dá»‹ch vá»¥ `WWW` (*Wordld Wide Web*) cá»§a `Internet`, sá»­ dá»¥ng káº¿t ná»‘i [TCP](https://vi.wikipedia.org/wiki/TCP) giá»¯a `client` vÃ  `server` 

> MÃ´ hÃ¬nh `Client` vÃ  `Server`
>
> <br>
> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-13-05-42-socket_client_server.webp">

::: tip ğŸ’¡ Máº¸O

- `TCP` lÃ  giao thá»©c truyá»n dá»¯ liá»‡u cÃ³ kiá»ƒm tra tÃ­nh toÃ n váº¹n cá»§a dá»¯ liá»‡u, trÆ°á»›c ngÆ°á»£c vá»›i `UDP` lÃ  khÃ´ng kiá»ƒm tra mÃ  gá»­i vÃ  nháº­n luÃ´n

- `TCP` cháº­m hÆ¡n so vá»›i `UDP` nhÆ°ng láº¡i Ä‘áº£m báº£o Ä‘Æ°á»£c tÃ­nh toÃ n váº¹n dá»¯ liá»‡u

- Trong thá»±c táº¿ `UDP` dÃ¹ng trong cÃ¡c dá»‹ch vá»¥ `Stream` vÃ¬ nÃ³ Æ°u tiÃªn tá»‘c Ä‘á»™ nÃªn Ä‘Ã´i lÃºc phÃ­a ngÆ°á»i coi sáº½ gÃ¢y ra má» video, vÃ  cháº­m chá»n...

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-13-10-36-an5d7xV_700b.jpg" width="250">
:::

### Giao thá»©c `DNS`

`Domain Name System` (*[DNS](https://vi.wikipedia.org/wiki/H%E1%BB%87_th%E1%BB%91ng_ph%C3%A2n_gi%E1%BA%A3i_t%C3%AAn_mi%E1%BB%81n)*) lÃ  há»‡ thá»‘ng phÃ¢n giáº£i tÃªn miá»n, nhiá»‡m vá»¥ Ä‘Ã³ lÃ  chuyá»ƒn `Äá»‹a chá»‰ tÃªn` thÃ nh `Ä‘á»‹a chá»‰ IP` vÃ  ngÆ°á»£c láº¡i

::: tip ğŸ’¡ GIáº¢I THÃCH

VÃ¬ trÃªn máº¡ng chá»‰ cÃ³ thá»ƒ nháº­n biáº¿t cÃ¡c Ä‘á»‹a chá»‰ thÃ´ng qua `IP` chá»© khÃ´ng pháº£i tÃªn 

> VÃ­ dá»¥ nhÆ° google.com, thá»±c cháº¥t nÃ³ cÃ³ Ä‘á»‹a chá»‰ `172.217.24.238`, nhÆ°ng nhá» `DNS` mÃ  ta chá»‰ cáº§n gÃµ `google.com` thÃ¬ nÃ³ sáº½ tá»± phÃ¢n giáº£i ra `IP`
>
> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-13-15-37-Screen%20Shot%202021-11-05%20at%2013.15.33.png">
:::

### Giao thá»©c `SMTP` vÃ  `IMAP`

ÄÃ¢y lÃ  má»™t trong nhá»¯ng giao thá»©c phá»• biáº¿n trong `Email Server`

- `Simple Mail Transfer Protocol` (*[SMTP](https://vi.wikipedia.org/wiki/SMTP)*) lÃ  giao thá»©c truyá»n táº£i `email` Ä‘Æ¡n giáº£n qua máº¡ng `Internet` cháº³ng háº¡n nhÆ° `Outlook`, `Gmail`... sá»­ dá»¥ng cá»•ng `25` trong giao thá»©c `TCP`

- `Internet Access Message Protocol` (*[IMAP](https://vi.wikipedia.org/wiki/Internet_Message_Access_Protocol)*) lÃ  má»™t giao thá»©c truyá»n táº£i `email` tá»« mÃ¡y chá»§ nháº­n, tá»©c lÃ  báº¡n chá»‰ cÃ³ thá»ƒ nháº­n tin qua giao thá»©c nÃ y trÃªn cá»•ng `143`

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-13-27-43-5637427471319040.svg">

## 2.BÃ i táº­p 15

::: tip ğŸ’¡ MÃ” HÃŒNH

Táº¡o mÃ´ hÃ¬nh máº¡ng nhÆ° sau:

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-13-25-25-Screen%20Shot%202021-11-05%20at%2013.25.18.png" width="500">
:::

### Táº¡o cÃ¡c thÆ° má»¥c vÃ  cÃ¡c file

Táº¡o cÃ¡c thÆ° má»¥c vÃ  file theo mÃ´ hÃ¬nh sau:

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-15-59-01-Screenshot%20from%202021-11-05%2015-58-27.png">

Báº±ng nhá»¯ng lá»‡nh sau: 

```sh
mkdir ~/Desktop/BaiTap15
cd ~/Desktop/BaiTap15
mkdir pc router1 router2 webserver
touch lab.conf pc.startup router1.startup router2.startup webserver.startup
```

### Thiáº¿t láº­p cÃ¡c file

Trong cÃ¡c file cáº¥u hÃ¬nh, hÃ£y cáº¥u hÃ¬nh theo mÃ´ hÃ¬nh trÃªn nhÆ° sau:

:::: tabs

  ::: tab lab.conf
  ```txt
  pc[0]=B
  router1[0]=A
  router1[1]=C
  router2[0]=B
  router2[1]=C
  webserver[0]=A
  ```
  :::

  ::: tab router1.startup
  ```txt
  ifconfig eth0 192.168.1.1/24 up
  ifconfig eth1 10.0.0.1/30 up
  route add -net 192.168.2.0/24 gw 10.0.0.2
  ```
  :::

  ::: tab router2.startup
  ```txt
  ifconfig eth0 192.168.2.1/24 up
  ifconfig eth1 10.0.0.2/30 up
  route add -net 192.168.2.1/24 gw 10.0.0.1
  ```
  :::

  ::: tab pc.startup
  ```txt
  ifconfig eth0 192.168.2.100/24 up
  route add default gw 192.168.2.1
  ```
  :::

  ::: tab webserver.startup
  ```txt
  ifconfig eth0 192.168.1.100/24 up
  route add default gw 192.168.1.1
  ```
  :::
::::

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-16-02-16-Screen%20Shot%202021-11-05%20at%2016.02.08.png">


### Khá»Ÿi Ä‘á»™ng há»‡ thá»‘ng mÃ¡y áº£o

Sá»­ dá»¥ng lá»‡nh `kathara lstart` Ä‘á»ƒ khá»Ÿi Ä‘á»™ng há»‡ thá»‘ng mÃ¡y áº£o Ä‘Ã£ táº¡o:

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-16-03-13-Screen%20Shot%202021-11-05%20at%2016.03.08.png" width="600">

==> KhÃ´ng cÃ³ lá»—i giá»¯a cÃ¡c `mÃ¡y áº£o`
### Cháº¡y dá»‹ch vá»¥ `WebServer`

Äá»ƒ cháº¡y dá»‹ch vá»¥ `WebServer`, ta pháº£i khá»Ÿi Ä‘á»™ng trÃªn `webserver` pháº§n má»m `apache2` báº±ng lá»‡nh sau:

```sh
/etc/init.d/apache2 start
```

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-16-06-47-Screen%20Shot%202021-11-05%20at%2016.06.41.png" width="430">
>
> ==> ÄÃ£ khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥ `apache2` 

TrÃªn `pc` hÃ£y má»Ÿ dá»‹ch vá»¥ web báº±ng lá»‡nh `links`

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-16-16-11-Screen%20Shot%202021-11-05%20at%2016.16.08.png" width="400">

::: tip ğŸ’¡ Máº¸O

Sá»­ dá»¥ng `F10` trÃªn `pc` Ä‘á»ƒ má»Ÿ `Menu Bar` vÃ  thao tÃ¡c tá»›i trÃ¬nh duyá»‡t web
:::

TrÃªn `webserver` hÃ£y gÃµ lá»‡nh sau Ä‘á»ƒ báº¯t cÃ¡c gÃ³i tin

```sh
tcpdump -s 1536 -w /shared/BaiTap15_webserver.pcap
```

Sau Ä‘Ã³ trÃªn `pc` hÃ£y báº¥m vÃ o `File => Go to URL` vÃ  nháº­p `https://192.168.1.100` (*Ä‘Ã¢y lÃ  Ä‘á»‹a chá»‰ cá»§a `webserver`*)

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-16-27-03-Screen%20Shot%202021-11-05%20at%2016.26.46.png" width="400">
>
> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-17-16-02-Screen%20Shot%202021-11-05%20at%2017.15.54.png" width="500">

Sau Ä‘Ã³ thoÃ¡t ra báº±ng cÃ¡ch nháº¥n `F10 => Exit`

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-17-16-44-Screen%20Shot%202021-11-05%20at%2017.16.20.png" width="350">

VÃ  dá»«ng lá»‡nh `tcpdump` trÃªn `pc` báº±ng `CTRL+C`

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/05-17-44-34-Screen%20Shot%202021-11-05%20at%2017.44.30.png">

### PhÃ¢n tÃ­ch gÃ³i tin báº±ng `WireShark`

Má»Ÿ file `BaiTap15_webserver.pcap` báº±ng á»©ng dá»¥ng `WireShark` 

#### Má»Ÿ khung `3` vÃ  chá»n má»¥c `Tranmisson Control Protocol Header`:

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/06-15-50-02-Screen%20Shot%202021-11-06%20at%2015.49.57.png">

::: tip ğŸ’¡ NHáº¬N XÃ‰T

- TrÃ¬nh duyá»‡t `links` Ä‘ang hoáº¡t Ä‘á»•ng á»Ÿ cá»•ng `43452`

- Dá»‹ch vá»¥ `Apache` Ä‘ang hoáº¡t Ä‘á»™ng á»Ÿ cá»•ng 80

- `Flag Syn` cÃ³ giÃ¡ trá»‹ bit lÃ  `1` Ä‘á»ƒ thÃ´ng bÃ¡o kÃ­ch thÆ°á»›c mÃ n hÃ¬nh cá»§a mÃ¡y `Client` Ä‘áº¿n `Server`, Sau Ä‘Ã³ `Server` sáº½ tráº£ vá» giao diá»‡n phÃ¹ há»£p cho mÃ n hÃ¬nh mÃ¡y `Client`

  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/06-15-53-56-Screen%20Shot%202021-11-06%20at%2015.53.48.png" width="300">
::: 

####  Chá»n khung sá»‘ `4` vÃ  chá»n má»¥c `Tranmisson Control Protocol Header`

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/06-15-56-47-Screen%20Shot%202021-11-06%20at%2015.56.43.png">

::: tip ğŸ’¡ NHáº¬N XÃ‰T

`Flag ACK vÃ  SYN` Ä‘Ã£ Ä‘Æ°á»£c báº­t lÃªn, Ä‘á»ƒ xÃ¡c nháº­n gá»­i gÃ³i tin thÃ nh cÃ´ng tá»« `Client` Ä‘áº¿n `Server` vÃ  `Server` cÅ©ng pháº£n há»“i thÃ nh cÃ´ng vá» phÃ­a `Client`
:::

#### Chá»n khung sá»‘ `6` vÃ  chá»n má»¥c `Tranmisson Control Protocol Header`

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/06-16-00-58-Screen%20Shot%202021-11-06%20at%2016.00.55.png">

::: tip ğŸ’¡ NHáº¬N XÃ‰T

- `Flag PUSH` Ä‘Ã£ Ä‘Æ°á»£c báº­t lÃªn Ä‘á»ƒ chá»‰ Ä‘á»‹nh mÃ¡y pháº£i chuyá»ƒn dá»¯ liá»‡u Ä‘i tá»›i `Server`

- `Flag FIN` Ä‘Ã£ Ä‘Æ°á»£c báº­t lÃªn Ä‘á»ƒ ngáº¯t káº¿t ná»‘i 3 chiá»u trong giao thá»©c `TCP`

- Trong `HTTP Header`:

  <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/06-16-02-55-Screen%20Shot%202021-11-06%20at%2016.02.51.png">

  + ThÃ´ng Ä‘iá»‡p `HTTP` gá»­i Ä‘i cÃ³ dáº¡ng `GET`

  + ThÃ´ng Ä‘iá»‡p cÃ³ mÃ£ lÃ  `200` nghÄ©a lÃ  `request is OK` (*Tham kháº£o [táº¡i Ä‘Ã¢y](https://www.w3schools.com/tags/ref_httpmessages.asp)*)
:::

### Há»§y há»‡ thá»‘ng mÃ¡y áº£o

Sá»­ dá»¥ng lá»‡nh `kathara lclean` Ä‘á»ƒ há»§y há»‡ thá»‘ng mÃ¡y áº£o:

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/06-16-06-37-Screen%20Shot%202021-11-06%20at%2016.06.29.png" width="600">

<comment/>
