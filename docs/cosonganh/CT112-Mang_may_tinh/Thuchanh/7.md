# Ã”n táº­p Máº¡ng mÃ¡y tÃ­nh

::: warning âš ï¸ LÆ¯U Ã

Chá»‰ tham kháº£o vÃ¬ má»—i há»c ká»³ sáº½ má»—i khÃ¡c nÃªn Ä‘Ã¢y lÃ  bÃ i tham kháº£o cá»§a nÄƒm `há»c ká»³ I-2021` cá»§a `Ä‘áº¡i há»c Cáº§n ThÆ¡`
:::

## CÃ¢u sá»‘ 1

::: tip â“ CÃ‚U Há»I

HÃ£y trÃ¬nh bÃ y má»i hiá»ƒu biáº¿t vá» giao thá»©c `RIP` vÃ  `OSFP` trong Ä‘á»‹nh tuyáº¿n ná»™i miá»n
:::


## CÃ¢u sá»‘ 2

::: tip â“ CÃ‚U Há»I

Cho sÆ¡ Ä‘á»“ máº¡ng Ä‘Æ°á»£c thiáº¿t káº¿ nhÆ° sau:

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/06-16-21-34-Screen%20Shot%202021-11-06%20at%2016.21.27.png">

-	HÃ£y Ä‘á» xuáº¥t cÃ¡c Ä‘á»‹a chá»‰ máº¡ng, Ä‘á»‹a chá»‰ IP phÃ¹ há»£p cho cÃ¡c LAN vÃ  cÃ¡c thiáº¿t bá»‹ trong sÆ¡ Ä‘á»“ máº¡ng

-	Sá»­ dá»¥ng Kathara Ä‘á»ƒ xÃ¢y dá»±ng mÃ´ hÃ¬nh máº¡ng
:::

### Táº¡o thÆ° má»¥c vÃ  cÃ¡c file

Táº¡o cÃ¡c thÆ° má»¥c theo mÃ´ hÃ¬nh nhÆ° sau:

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/13-13-52-10-Screenshot%20from%202021-11-13%2013-50-18.png">

Báº±ng cÃ¡c dÃ²ng lá»‡nh dÆ°á»›i Ä‘Ã¢y :

```sh
mkdir ~/Desktop/OnTap
cd ~/Desktop/OnTap
mkdir webserver pc1 pc2 switch1 router0 router1 router2 router3 router4 router5 router6
touch webserver.startup pc1.startup pc2.startup switch1.startup
touch router0.startup router1.startup router2.startup router3.startup router4.startup router5.startup router6.startup
```

### Thiáº¿t láº­p cÃ¡c file

#### MÃ´ hÃ¬nh láº¡i bÃ i toÃ¡n

::: warning âš ï¸ LÆ¯U Ã

VÃ¬ mÃ´ hÃ¬nh trÃªn Ä‘á» bÃ i khÃ´ng cÃ³ cÃ¡c nhÃ¡nh máº¡ng nÃªn ta pháº£i tá»± mÃ´ hÃ¬nh cÃ¡ nhÃ¢n nhÆ° sau:

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/12-22-24-34-06-16-21-34-Screen%20Shot%202021-11-06%20at%2016.21.27.png">

Tá»‘t nháº¥t lÃ  báº¡n nÃªn lÃ m theo `quy táº¯c` thá»© tá»± **chá»¯ cÃ¡i** vÃ  **sá»‘**
:::

#### Cáº¥u hÃ¬nh file `lab.conf`

NhÃ¬n theo mÃ´ hÃ¬nh vÃ  ta cáº¥u hÃ¬nh file `lab.conf` nhÆ° sau:

```txt
webserver[0]=A
pc1[0]=F
pc2[0]=G

switch1[0]=F
switch1[1]=G
switch1[2]=H

router0[0]=C
router0[1]=D
router0[2]=I
router0[3]=J

router1[0]=B  
router1[1]=C

router2[0]=A
router2[1]=B
router2[2]=E

router3[0]=D
router3[1]=E

router4[0]=J
router4[1]=K

router5[0]=K
router5[1]=M

router6[0]=H
router6[1]=I
router6[2]=M
```

#### Cáº¥u hÃ¬nh cÃ¡c thiáº¿t bá»‹ 

NhÃ¬n trÃªn mÃ´ hÃ¬nh ta sáº½ cÃ³ cÃ¡c thiáº¿t bá»‹ nhÆ°: `webserver`, `pc1`, `pc2`, `switch1`

:::: tabs

  ::: tab webserver.startup
  ```txt
  ifconfig eth0 12.18.10.139/25 up
  route add default gw 12.18.10.140
  ```
  :::

  ::: tab pc1.startup
  ```txt
  ifconfig eth0 192.168.10.10/24 up
  route add default gw 192.168.10.1
  ```
  :::

  ::: tab pc2.startup
  ```txt
  ifconfig eth0 192.168.10.11/24
  route add default gw 192.168.10.1
  ```
  :::

  ::: tab switch1.startup
  ```txt
  ifconfig eth0 up
  ifconfig eth1 up
  ifconfig eth2 up 
  brctl addbr br0

  brctl addif br0 eth0
  brctl addif br0 eth1
  brctl addif br0 eth2

  brctl stp br0 on
  ifconfig br0 up
  ```
  :::
::::

::: warning âš ï¸ LÆ¯U Ã

- `webserver` káº¿t ná»‘i tá»›i `eth0` cá»§a `router2`, ta cho `12.18.10.140` 
  
  thÃ¬ ta báº¯t buá»™c pháº£i cáº¥u hÃ¬nh `eth0` cá»§a `router2` y váº­y

- `pc1` vÃ  `pc2` káº¿t ná»‘i vá»›i `eth0` cá»§a `router6`, ta cho `192.168.10.1`
  
  thÃ¬ ta báº¯t buá»™c pháº£i cáº¥u hÃ¬nh `eth0` cá»§a `router6` y váº­y
:::

#### Cáº¥u hÃ¬nh cÃ¡c `router`

::: tip ğŸ’¡ NHáº¬N XÃ‰T

- `router1`, `router2`, `router3` theo nhÃ¡nh máº¡ng `110.178.29.192/27` vÃ  sá»­ dá»¥ng giáº£i thuáº­t `OSPF`

- `router4`, `router5`, `router6` theo nhÃ¡nh máº¡ng `110.84.59.0/25` vÃ  sá»­ dá»¥ng giáº£i thuáº­t `RIP`

- `router0` theo cáº£ 2 nhÃ¡nh máº¡ng trÃªn vÃ  sá»­ dá»¥ng Ä‘á»“ng thá»i `OSPF` vÃ  `RIP`
:::

#### Chia nhÃ¡nh máº¡ng con

ChÃºng ta pháº£i thá»±c hiá»‡n chia nhÃ¡ng máº¡ng con, gá»“m 2 `nhÃ¡nh` má»—i nhÃ¡nh chia 4 máº¡ng con 

==> ChÃºng ta pháº£i chia cho `8` nhÃ¡nh vÃ¬ `4`  nhÃ¡nh nhÆ°ng chá»‰ sá»­ dá»¥ng Ä‘Æ°á»£c `2` nhÃ¡nh máº¡ng con

::: tip ğŸ’¡ Máº¸O 

Äá»ƒ má»i thá»© Ä‘Æ°á»£c dá»… dÃ ng hÆ¡n, sá»­ dá»¥ng cÃ´ng cá»¥ [easy-subnet](https://github.com/BrunoBonacci/easy-subnet) Ä‘á»ƒ chia nhÃ¡nh máº¡ng con tá»± Ä‘á»™ng
:::


<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/12-15-43-17-Screen%20Shot%202021-11-12%20at%2015.43.09.png">

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/12-15-44-30-Screen%20Shot%202021-11-12%20at%2015.44.22.png">

::: warning âš ï¸ LÆ¯U Ã

NhÆ° trÃªn hÃ¬nh, chÃºng ta khÃ´ng sá»­ dá»¥ng nhÃ¡nh máº¡ng `net1` vÃ¬ nÃ³ trÃ¹ng vá»›i máº¡ng gá»‘c vÃ  khÃ´ng sá»­ dá»¥ng `net8` vÃ¬ nÃ³ trÃ¹ng vá»›i `boardcast` máº¡ng gá»‘c

==> ChÃºng ta sá»­ dá»¥ng tá»« `net2` â†’ `net5`

VÃ  tá»« cÃ¡c nhÃ¡nh máº¡ng, hÃ£y láº­p ra danh sÃ¡ch cÃ¡c `router` káº¿t ná»‘i vá»›i nÃ³ vÃ  Ä‘áº·t `IP` theo tá»© tá»± tÄƒng dáº§n
:::

| NhÃ¡nh | Máº¡ng              | Router                             |
| ----- | ----------------- | ---------------------------------- |
| B     | 110.178.29.196/30 | router1 (`197`)<br>router2 (`198`) |
| C     | 110.178.29.200/30 | router0 (`201`)<br>router1 (`202`) |
| D     | 110.178.29.204/30 | router0 (`205`)<br>router3 (`206`) |
| E     | 110.178.29.208/30 | router2 (`209`)<br>router3 (`210`) |

| NhÃ¡nh | Máº¡ng            | Router                           |
| ----- | --------------- | -------------------------------- |
| I     | 110.84.59.16/28 | router0 (`17`)<br>router6 (`18`) |
| J     | 110.84.59.32/28 | router0 (`33`)<br>router4 (`34`) |
| K     | 110.84.59.48/28 | router4 (`49`)<br>router5 (`50`) |
| M     | 110.84.59.64/28 | router5 (`65`)<br>router6 (`66`) |

::: tip ğŸ’¡ Máº¸O

Náº¿u mÃ´ hÃ¬nh theo thá»© tá»± vÃ  cÃ³ quy táº¯c, sáº½ khÃ´ng cáº§n pháº£i nhÃ¬n mÃ´ hÃ¬nh mÃ  nhÃ¬n tháº³ng báº£ng trÃªn
:::

Tá»« báº£ng trÃªn ta cáº¥u hÃ¬nh cÃ¡c `router` nhÆ° sau:

:::: tabs 

  ::: tab router0.startup
  ```txt
  ifconfig eth0 110.178.29.201/30 up
  ifconfig eth1 110.178.29.205/30 up
  ifconfig eth2 110.84.59.17/28 up
  ifconfig eth3 110.84.59.33/28 up
  /etc/init.d/quagga start
  ```
  :::

  ::: tab router1.startup
  ```txt
  ifconfig eth0 110.178.29.197/30 up
  ifconfig eth1 110.178.29.202/30 up
  /etc/init.d/quagga start
  ```
  :::

  ::: tab router2.startup
  ```txt
  ifconfig eth0 12.18.10.140/25 up
  ifconfig eth1 110.178.29.198/30 up
  ifconfig eth2 110.178.29.209/30 up
  /etc/init.d/quagga start
  ```
  :::

  ::: tab router3.startup
  ```txt
  ifconfig eth0 110.178.29.206/30 up
  ifconfig eth1 110.178.29.210/30 up
  /etc/init.d/quagga start
  ```  
  :::

  ::: tab router4.startup
  ```txt
  ifconfig eth0 110.84.59.34/28 up
  ifconfig eth1 110.84.59.49/28 up
  /etc/init.d/quagga start
  ```
  :::

  ::: tab router5.startup
  ```txt
  ifconfig eth0 110.84.59.50/28 up
  ifconfig eth1 110.84.59.65/28 up
  /etc/init.d/quagga start
  ```
  :::

  ::: tab router6.startup
  ```txt
  ifconfig eth0 192.168.10.1/24 up
  ifconfig eth1 110.84.59.18/28 up
  ifconfig eth2 110.84.59.66/28 up
  /etc/init.d/quagga start
  ```  
  :::
::::

> `/etc/init.d/quagga start` lÃ  Ä‘á»ƒ khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥ Ä‘á»‹nh tuyáº¿n ná»™i miá»n tá»± Ä‘á»™ng, thay cho lá»‡nh `route add -net` (*Ä‘Ã¢y lÃ  Ä‘á»‹nh tuyáº¿n thá»§ cÃ´ng*)

### Cáº¥u hÃ¬nh dá»‹ch vá»¥ `Quagga`

::: tip ğŸ’¡ NHáº¬N XÃ‰T

Ta phÃ¢n ra `3` pháº§n cáº¥u hÃ¬nh nhÆ° sau :

- `router4`, `router5`, `router6` sá»­ dá»¥ng giáº£i thuáº­t `RIP` (*nÃªn lÃ m trÆ°á»›c*)

- `router1`, `router2`, `router3` sá»­ dá»¥ng giáº£i thuáº­t `OSPF` 

- `router0` sá»­ dá»¥ng cáº£ 2 giáº£i thuáº­t trÃªn
:::

#### Cáº©u hÃ¬nh cho `router` sá»­ dá»¥ng `RIP`

> Cá»¥ thá»ƒ lÃ  `router4`, `router5`, `router6`

Tá»« `router4` hÃ£y táº¡o thÆ° má»¥c vÃ  cÃ¡c file nhÆ° sau:

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/13-14-13-28-Screen%20Shot%202021-11-13%20at%2014.13.24.png"> 

:::: tabs

  ::: tab daemons
  ```txt
  zebra=yes
  ripd=yes
  ```
  :::

  ::: tab zebra.conf
  ```txt
  hostname zebra
  password zebra
  enable password zebra
  ```
  :::

  ::: tab rip.conf
  ```txt
  hostname ripd
  password zebra
  enable password zebra

  router rip
  network 110.84.59.0/25
  redistribute connected
  ```
  :::
::::

::: tip ğŸ’¡ Máº¸O

HÃ£y copy file tá»« `router4` qua `router5` vÃ  `router6` nhÆ° sau:

```
cp -r router4/etc router5
cp -r router4/etc router6
```
:::

#### Cáº¥u hÃ¬nh cho `router` sá»­ dá»¥ng `OSPF`

> Cá»¥ thá»ƒ lÃ  `router1`, `router2`, `router3`

Tá»« `router1` hÃ£y táº¡o thÆ° má»¥c vÃ  cÃ¡c file nhÆ° sau:

> <img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/13-14-18-59-Screen%20Shot%202021-11-13%20at%2014.18.55.png">

:::: tabs

  ::: tab daemons
  ```txt
  zebra=yes
  ospfd=yes
  ```
  :::

  ::: tab zebra.conf
  ```txt
  hostname zebra
  password zebra
  enable password zebra
  ```
  :::
::::

:::: tabs 

  ::: tab ospfd.conf (router1)
  ```txt
  hostname ospfd
  password zebra
  enable password zebra

  interface eth0
  interface eth1
  ospf cost 20

  router ospf
  network 110.178.29.192/27 area 0.0.0.0
  redistribute connected
  ```
  :::

  ::: tab ospfd.conf (router2)
  ```txt
  hostname ospfd
  password zebra
  enable password zebra

  interface eth1
  interface eth2
  ospf cost 40

  router ospf
  network 110.178.29.192/27 area 0.0.0.0
  redistribute connected
  ```  
  :::

  ::: tab ospfd.conf (router3)
  ```txt
  hostname ospfd
  password zebra
  enable password zebra

  interface eth0
  interface eth1
  ospf cost 60

  router ospf
  network 110.178.29.192/27 area 0.0.0.0
  redistribute connected
  ```
  :::
::::

::: danger ğŸš¨ CHÃš Ã

Má»—i `router` cáº¥u hÃ¬nh `OSPF` sáº½ má»—i khÃ¡c

HÃ£y Ä‘á»ƒ Ã½ `interface` vÃ  `cost` cá»§a chÃºng
:::

> Báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh `cp` nhÆ° trÃªn Ä‘á»ƒ lÃ m nhanh quÃ¡ trÃ¬nh

#### Cáº¥u hÃ¬nh cho `router0`

ÄÃ¢y lÃ  `router` Ä‘áº·c biá»‡t nÃªn ta pháº£i cáº¥u hÃ¬nh nhÆ° sau:

:::: tabs

  ::: tab daemons
  ```txt
  zebra=yes
  ospfd=yes
  ripd=yes
  ```
  :::

  ::: tab zebra.conf
  ```txt
  hostname zebra
  password zebra
  enable password zebra
  ```
  :::

  ::: tab ripd.conf
  ```txt
  hostname ripd
  password zebra
  enable password zebra

  router rip
  network 110.84.59.0/25
  redistribute connected

  redistribute ospf
  ```
  :::

  ::: tab ospfd.conf
  ```txt
  hostname ospfd
  password zebra
  enable password zebra

  interface eth0
  interface eth1
  ospf cost 15

  router ospf
  network 110.178.29.192/27 area 0.0.0.0
  redistribute connected

  redistribute rip
  ```
  :::
::::

::: danger ğŸš¨ CHÃš Ã

- á» `daemons` ta khá»Ÿi Ä‘á»™ng cáº£ 2 giáº£i thuáº­t `ripd` vÃ  `ospfd`

- á» `ripd.conf` ta thÃªm dÃ²ng `redistribute ospf` Ä‘á»ƒ phÃ¢n phá»‘i cÃ¹ng vá»›i giáº£i thuáº­t `OSPF`

- á» `ospfd.conf` ta thÃªm dÃ²ng `redistribute rip` Ä‘á»ƒ phÃ¢n phá»‘i cÃ¹ng vá»›i giáº£i thuáº­t `RIP` vÃ  cost lÃ  `15`
:::


### Khá»Ÿi Ä‘á»™ng há»‡ thá»‘ng mÃ¡y áº£o

Sá»­ dá»¥ng lá»‡nh `kathara lstart` Ä‘á»ƒ khá»Ÿi Ä‘á»™ng há»‡ thá»‘ng mÃ¡y áº£o

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/13-14-55-29-Screen%20Shot%202021-11-13%20at%2014.55.21.png">

::: tip ğŸ’¡ Máº¸O

- HÃ£y xem trÃªn má»—i thiáº¿t bá»‹ cÃ³ cÃ¡i nÃ o bÃ¡o lá»—i cáº¥u hÃ¬nh network sai => náº¿u cÃ³ ta hÃ£y sá»­a nÃ³

- HÃ£y kiá»ƒm tra dá»‹ch vá»¥ `quagga` trÃªn cÃ¡c `router` báº±ng lá»‡nh sau:

  ```sh
  /etc/init.d/quagga status
  ```

==> Khi Ä‘Ã£ sá»­a cÃ¡c sai sÃ³t hÃ£y gÃµ lá»‡nh `kathara lrestart` Ä‘á»ƒ khá»Ÿi Ä‘á»™ng láº¡i há»‡ thá»‘ng mÃ¡y áº£o
:::

#### Kiá»ƒm tra liÃªn thÃ´ng cá»§a cÃ¡c thiá»‡t bá»‹

Ta khÃ´ng cáº§n thiáº¿t pháº£i kiá»ƒm tra háº¿t thiáº¿t bá»‹, hÃ£y láº¥y ngáº«u nhiÃªn 2 cÃ¡i báº¡n thÃ­ch

> MÃ¬nh sáº½ láº¥y `router1` vÃ  `router4`

Tá»« 2 thiáº¿t bá»‹ nÃ y hÃ£y gÃµ lá»‡nh `route` nhÆ° sau vÃ  quan sÃ¡t báº£ng váº¡ch Ä‘Æ°á»ng

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/13-15-05-05-Screen%20Shot%202021-11-13%20at%2015.04.09.png">

::: tip ğŸ’¡ NHáº¬N XÃ‰T

- Khung mÃ u `cam` cho tháº¥y cÃ³ thá»ƒ `ping` tá»›i `webserver`

- Khung mÃ u `Ä‘á»` cho tháº¥y cÃ³ thá»ƒ `ping` tá»›i `router0`, `router4`, `router5`, `router6`

- Khung mÃ u `xanh` cho tháº¥y cÃ³ thá»ƒ `ping` tá»›i `router0`, `router1`, `router2`, `router3`

- Khung mÃ u `tÃ­m` cho tháº¥y cÃ³ thá»ƒ `ping` tá»›i `pc1`, `pc2`, `switch1`

==> Ta khÃ´ng cáº§n pháº£i kiá»ƒm tra lá»‡nh `ping` náº¿u báº£ng váº¡ch Ä‘Æ°á»ng, nhÆ°ng báº¡n hoÃ n toÃ n cÃ³ thá»ƒ Ä‘á»ƒ cháº¯c cháº¯n
:::

### Khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥ `webserver`

Tá»« `webserver` hÃ£y gÃµ lá»‡nh sau Ä‘á»ƒ khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥ `apache2`

```sh
/etc/init.d/apache2 start
```

Sau Ä‘Ã³ tá»« `pc1` vÃ  `pc2` gÃµ lá»‡nh `links` vÃ  káº¿t ná»‘i Ä‘áº¿n `12.18.10.139` (*ip cá»§a `webserver`*)

> GÃµ `F10` Ä‘á»ƒ ra `Menubar`

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/13-15-12-49-Screen%20Shot%202021-11-13%20at%2015.12.35.png">

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/13-15-12-52-Screen%20Shot%202021-11-13%20at%2015.12.44.png">

### Há»§y há»‡ thá»‘ng mÃ¡y áº£o

Sá»­ dá»¥ng lá»‡nh `kathara lclean` Ä‘á»ƒ há»§y há»‡ thá»‘ng mÃ¡y áº£o

<img src="https://raw.githubusercontent.com/Zenfection/Image/master/2021/11/13-15-13-46-Screen%20Shot%202021-11-13%20at%2015.13.38.png" width="600">


```txt

```
